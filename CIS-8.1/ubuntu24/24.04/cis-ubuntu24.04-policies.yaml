apiVersion: v1
kind: policy
spec:
  name: CIS 1.1 UBTU-24-90890 (Automated)
  platform: linux
  description: The operating system must use cryptographic mechanisms to protect the integrity of audit tools.
  resolution: "Configure AIDE to protect the integrity of audit tools:\n            Add or modify the following lines in the \"/etc/aide/aide.conf\" file:\n            # Audit Tools\n            /sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512\n            /sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha512\n            /sbin/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512\n            /sbin/aureport p+i+n+u+g+s+b+acl+xattrs+sha512\n            /sbin/autrace p+i+n+u+g+s+b+acl+xattrs+sha512\n            /sbin/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/aide/aide.conf' AND (line LIKE '%/sbin/auditctl%' OR line LIKE '%/sbin/auditd%' OR line LIKE '%/sbin/ausearch%' OR line LIKE '%/sbin/aureport%' OR line LIKE '%/sbin/autrace%' OR line LIKE '%/sbin/augenrules%') AND line LIKE '%sha512%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_90890, cis_category:General Information, cis_subcategory:General, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.2 UBTU-24-100010 (Automated)
  platform: linux
  description: The operating system must not have the "systemd-timesyncd" package installed.
  resolution: "The \"systemd-timesyncd\" package will be uninstalled as part of the \"chrony\" package\n            install. The remaining configuration files for \"systemd-timesyncd\" must be purged from\n            the operating system:\n            $ sudo apt-get purge systemd-timesyncd"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM deb_packages WHERE name='systemd-timesyncd');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100010, cis_category:Audit Log Management, cis_subcategory:Standardize Time Synchronization, cis_safeguard_ids:CIS8.4
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.3 UBTU-24-100020 (Automated)
  platform: linux
  description: The operating system must not have the "ntp" package installed.
  resolution: "Uninstall the \"ntp\" package by using the following command:\n            $ sudo apt-get purge ntp"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM deb_packages WHERE name='ntp');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100020, cis_category:Audit Log Management, cis_subcategory:Standardize Time Synchronization, cis_safeguard_ids:CIS8.4
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.4 UBTU-24-100030 (Automated)
  platform: linux
  description: The operating system must not have the "telnet" package installed.
  resolution: "Remove the \"telnetd\" package by using the following command:\n            $ sudo apt-get remove telnetd"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM deb_packages WHERE name='telnetd');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100030, cis_category:Secure Configuration, cis_subcategory:Uninstall or Disable Unnecessary Services on, cis_safeguard_ids:CIS4.8
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.5 UBTU-24-100040 (Automated)
  platform: linux
  description: The operating system must not have the "rsh-server" package installed.
  resolution: "Remove the \"rsh-server\" package by using the following command:\n            $ sudo apt-get remove rsh-server"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM deb_packages WHERE name='rsh-server');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100040, cis_category:Secure Configuration, cis_subcategory:Uninstall or Disable Unnecessary Services on, cis_safeguard_ids:CIS4.8
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.6 UBTU-24-100100 (Automated)
  platform: linux
  description: The operating system must use a file integrity tool to verify correct operation of all security functions.
  resolution: "Install the \"aide\" package:\n            $ sudo apt install aide"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM deb_packages WHERE name='aide');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100100, cis_category:Data Protection, cis_subcategory:Log Sensitive Data Access, cis_safeguard_ids:CIS3.14
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.7 UBTU-24-100110 (Manual)
  platform: linux
  description: The operating system must configure AIDE to perform file integrity checking on the file system.
  resolution: "Initialize AIDE (this will take a few minutes):\n            $ sudo aideinit\n\n            Running aide --init..\n            The new database will need to be renamed to be read by AIDE:\n            $ sudo cp -p /var/lib/aide/aide.db.new /var/lib/aide/aide.db\n            Perform a manual check:\n            $ sudo aide -c /etc/aide/aide.conf --check\n            Example output:\n            ...\n            Start timestamp: 2024-10-30 14:22:38 -0400 (AIDE 0.18.6)\n            AIDE found differences between database and filesystem!!\n            ...\n\n            Done."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/aide/aide.conf');
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100110, cis_category:Data Protection, cis_subcategory:Log Sensitive Data Access, cis_safeguard_ids:CIS3.14
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.8 UBTU-24-100120 (Manual)
  platform: linux
  description: The operating system must be configured so that the script that runs each 30 days or less to check file integrity is the default.
  resolution: "The cron file for AIDE is fairly complex as it creates the report. This file is installed with\n            the \"aide-common\" package, and the default can be restored by copying it from the\n            package:\n            Download the original package to the /tmp dir:\n            $ cd /tmp; apt download aide-common\n            Extract the aide script to its original place:\n            $ dpkg-deb --fsys-tarfile /tmp/aide-common_*.deb | sudo tar -x --wildcards\n            ./usr/share/aide/config/cron.daily/dailyaidecheck* -C /\n            Copy it to the cron.daily directory:\n            $ sudo cp -f /usr/share/aide/config/cron.daily/aide\n            /etc/cron.daily/dailyaidecheck*"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/cron%' AND line LIKE '%aide%' AND line NOT LIKE '#%');
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100120, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.9 UBTU-24-100130 (Automated)
  platform: linux
  description: The operating system must notify designated personnel if baseline configurations are changed in an unauthorized manner. The file integrity tool must notify the system administrator when changes to the baseline configuration or anomalies in the operation of any security functions are discovered.
  resolution: "Configure AIDE to notify designated personnel if baseline configurations are changed in\n            an unauthorized manner.\n            Add or modify the following line in the \"/etc/default/aide\" file:\n            SILENTREPORTS=no\n\n\n\n\n                                                                                             Page 35\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/default/aide' AND line LIKE '%SILENTREPORTS%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100130, cis_category:Security Awareness and Skills Training, cis_subcategory:Enforce Detail Logging for Access or Changes to, cis_safeguard_ids:CIS14.9
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.10 UBTU-24-100200 (Automated)
  platform: linux
  description: The operating system must be configured to preserve log records from failure events.
  resolution: "Install the log service by using the following command:\n            $ sudo apt-get install rsyslog\n            Enable and activate the log service by using the following command:\n            $ sudo systemctl enable rsyslog.service --now\n\n\n\n                                                                                                      Page 37\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM deb_packages WHERE name='rsyslog') AND EXISTS (SELECT 1 FROM systemd_units WHERE id='rsyslog.service' AND active_state='active');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100200, cis_category:Audit Log Management, cis_subcategory:Collect Audit Logs, cis_safeguard_ids:CIS8.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.11 UBTU-24-100300 (Automated)
  platform: linux
  description: The operating system must have an application firewall installed in order to control remote access methods.
  resolution: "Install the Uncomplicated Firewall by using the following command:\n            $ sudo apt install -y ufw\n\n\n\n\n                                                                                                Page 39\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM deb_packages WHERE name='ufw');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100300, cis_category:Secure Configuration, cis_subcategory:Implement and Manage a Firewall on Servers, cis_safeguard_ids:CIS4.4
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.12 UBTU-24-100310 (Automated)
  platform: linux
  description: The operating system must enable and run the Uncomplicated Firewall (ufw).
  resolution: "Enable the ufw by using the following command:\n            $ sudo ufw enable"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM systemd_units WHERE id='ufw.service' AND active_state='active');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100310, cis_category:Secure Configuration, cis_subcategory:Implement and Manage a Firewall on Servers, cis_safeguard_ids:CIS4.4
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.13 UBTU-24-100400 (Automated)
  platform: linux
  description: The operating system must have the "auditd" package installed.
  resolution: "Install the \"auditd\" package by using the following command:\n            $ sudo apt-get install auditd"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM deb_packages WHERE name='auditd');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100400, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.14 UBTU-24-100410 (Automated)
  platform: linux
  description: The operating system must produce audit records and reports containing information to establish when, where, what type, the source, and the outcome for all DOD-defined auditable events and actions in near real time.
  resolution: "Verify the \"auditd.service\" is enabled and active by using the following commands:\n            $ systemctl is-enabled auditd.service\n\n            enabled\n            $ systemctl is-active auditd.service\n\n            active\n            If the \"auditd.service\" is not enabled and active, this is a finding.\n            Enable and start the \"auditd.service\" by using the following command:\n            $ sudo systemctl enable auditd.service --now"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM systemd_units WHERE id='auditd.service' AND active_state='active');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100410, cis_category:Audit Log Management, cis_subcategory:Collect Audit Logs, cis_safeguard_ids:CIS8.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.15 UBTU-24-100450 (Automated)
  platform: linux
  description: The operating system audit event multiplexor must be configured to offload audit logs onto a different system from the system being audited.
  resolution: "Configure the audit event multiplexor to offload audit records to a different system from\n            the system being audited.\n            Install the \"audisp-plugins\" package by using the following command:\n            $ sudo apt-get install audispd-plugins\n            Set the audisp-remote plugin as active by editing the \"/etc/audit/plugins.d/au-\n            remote.conf\" file:\n            $ sudo sed -i -E 's/active\\s*=\\s*no/active = yes/' /etc/audit/plugins.d/au-\n            remote.conf\n            Set the IP address of the remote system by editing the \"/etc/audit/audisp-remote.conf\"\n            file:\n            $ sudo sed -i -E 's/(remote_server\\s*=).*/\\1 <remote_server_ip_address>/'\n            /etc/audit/audisp-remote.conf\n            Restart the \"auditd.service\" for the changes to take effect:\n            $ sudo systemctl restart auditd.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/audit/plugins.d/au-remote.conf' AND line LIKE '%active%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100450, cis_category:Audit Log Management, cis_subcategory:Collect Audit Logs, cis_safeguard_ids:CIS8.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.16 UBTU-24-100500 (Automated)
  platform: linux
  description: The operating system must have the "apparmor" package installed.
  resolution: "Install the \"appArmor\" package by using the following command:\n            $ sudo apt-get install apparmor"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM deb_packages WHERE name='apparmor');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100500, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.17 UBTU-24-100510 (Automated)
  platform: linux
  description: The operating system must be configured to use AppArmor.
  resolution: "Enable and start \"apparmor.service\" by using the following command:\n            $ sudo systemctl enable apparmor.service --now\n            Note: AppArmor must have properly configured profiles for applications and home\n            directories. All configurations will be based on the actual system setup and organization\n            and normally are on a per role basis. See the AppArmor documentation for more\n            information on configuring profiles."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM systemd_units WHERE id='apparmor.service' AND active_state='active');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100510, cis_category:Access Control Management, cis_subcategory:Define and Maintain Role-Based Access Control, cis_safeguard_ids:CIS6.8
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.18 UBTU-24-100600 (Automated)
  platform: linux
  description: The operating system must have the "libpam-pwquality" package installed.
  resolution: "Install the \"pam_pwquality\" package by using the following command:\n            $ sudo apt install -y libpam-pwquality"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM deb_packages WHERE name='libpam-pwquality');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100600, cis_category:General Information, cis_subcategory:Ensure libpam-pwquality is installed, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.19 UBTU-24-100650 (Automated)
  platform: linux
  description: The operating system must have the "SSSD" package installed.
  resolution: "Install the sssd.service and the required pam packages with the following commands:\n            $ sudo apt install -y sssd\n            $ sudo apt install -y libpam-sss\n            $ sudo apt install -y libnss-sss\n\n\n\n\n                                                                                                Page 64\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM deb_packages WHERE name='sssd');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100650, cis_category:General Information, cis_subcategory:General, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.20 UBTU-24-100660 (Automated)
  platform: linux
  description: The operating system must use the "SSSD" package for multifactor authentication services.
  resolution: "Enable the \"sssd.service to start automatically on reboot with the following command:\n            $ sudo systemctl enable sssd.service\n            ensure the \"sssd\" service is running\n            $ sudo systemctl start sssd.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM systemd_units WHERE id='sssd.service' AND active_state='active');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100660, cis_category:General Information, cis_subcategory:General, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.21 UBTU-24-100700 (Automated)
  platform: linux
  description: The operating system must have the "chrony" package installed.
  resolution: "Install the \"chrony\" network time protocol package using the following command:\n            $ sudo apt install -y chrony"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM deb_packages WHERE name='chrony');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100700, cis_category:Audit Log Management, cis_subcategory:Standardize Time Synchronization, cis_safeguard_ids:CIS8.4
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.22 UBTU-24-100800 (Automated)
  platform: linux
  description: The operating system must have SSH installed.
  resolution: "Install the \"ssh\" meta-package by using the following command:\n            $ sudo apt install ssh"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM deb_packages WHERE name='openssh-server');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100800, cis_category:Data Protection, cis_subcategory:Encrypt Sensitive Data in Transit, cis_safeguard_ids:CIS3.10
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.23 UBTU-24-100810 (Automated)
  platform: linux
  description: The operating system must use SSH to protect the confidentiality and integrity of transmitted information.
  resolution: "Enable and start the \"ssh.service\" by using the following command:\n            $ sudo systemctl enable ssh.service --now\n            ensure the \"ssh\" service is running\n            $ sudo systemctl start ssh.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM systemd_units WHERE id='ssh.service' AND active_state='active');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100810, cis_category:Data Protection, cis_subcategory:Encrypt Sensitive Data in Transit, cis_safeguard_ids:CIS3.10
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.24 UBTU-24-100820 (Automated)
  platform: linux
  description: The operating system must configure the SSH daemon to use FIPS 140-3-approved ciphers to prevent the unauthorized disclosure of information and/or detect changes to information during transmission.
  resolution: "Configure the SSH server to only implement FIPS-approved ciphers.\n            Add or modify the following line in the \"/etc/ssh/sshd_config\" file:\n            Ciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes128-ctr\n            Restart the SSH server for the changes to take effect:\n            $ sudo systemctl restart sshd.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/sshd_config%' AND (line LIKE 'Ciphers aes256-gcm@openssh%' OR line LIKE ' Ciphers aes256-gcm@openssh%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100820, cis_category:Data Protection, cis_subcategory:Encrypt Sensitive Data in Transit, cis_safeguard_ids:CIS3.10
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.25 UBTU-24-100830 (Automated)
  platform: linux
  description: The operating system must configure the SSH daemon to use Message Authentication Codes (MACs) employing FIPS 140-3-approved cryptographic hashes to prevent the unauthorized disclosure of information and/or detect changes to information during transmission.
  resolution: "Configure the SSH server to only use MACs that employ FIPS 140-3 approved hashes.\n            Add or modify the following line in the \"/etc/ssh/sshd_config\" file:\n            MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-\n            512,hmac-sha2-256\n            Restart the SSH server for the changes to take effect:\n            $ sudo systemctl reload sshd.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/sshd_config%' AND (line LIKE 'MACs hmac-sha2-512-etm@openssh%' OR line LIKE ' MACs hmac-sha2-512-etm@openssh%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100830, cis_category:Data Protection, cis_subcategory:Encrypt Sensitive Data in Transit, cis_safeguard_ids:CIS3.10
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.26 UBTU-24-100840 (Automated)
  platform: linux
  description: The operating system SSH server must be configured to use only FIPS-validated key exchange algorithms.
  resolution: "Configure the SSH server to use only FIPS-validated key exchange algorithms.\n            Add or modify the following line in the \"/etc/ssh/sshd_config\" file:\n            KexAlgorithms ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-\n            nistp256,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-\n            sha512,diffie-hellman-group14-sha256\n\n            Restart the SSH server for changes to take effect:\n            $ sudo systemctl restart sshd.service\n\n\n\n                                                                                               Page 80\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/sshd_config%' AND (line LIKE 'KexAlgorithms ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256,diffie-hellman-group16-sha512,diffie-hellman-group14-sha256%' OR line LIKE ' KexAlgorithms ecdh-sha2-nistp521%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100840, cis_category:Data Protection, cis_subcategory:Encrypt Sensitive Data in Transit, cis_safeguard_ids:CIS3.10
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.27 UBTU-24-100850 (Automated)
  platform: linux
  description: The operating system must configure the SSH client to use FIPS 140-3 approved ciphers to prevent the unauthorized disclosure of information and/or detect changes to information during transmission.
  resolution: "Configure the operating system SSH client to use only ciphers employing FIPS 140-3\n            approved algorithms by updating the \"/etc/ssh/ssh_config\" file with the following line:\n            Ciphers aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes128-ctr\n            Restart the \"ssh\" service for changes to take effect:\n            $ sudo systemctl restart ssh"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/ssh_config%' AND (line LIKE 'Ciphers aes256-gcm@openssh%' OR line LIKE ' Ciphers aes256-gcm@openssh%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100850, cis_category:General Information, cis_subcategory:Ensure sshd Ciphers are configured, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.28 UBTU-24-100860 (Automated)
  platform: linux
  description: The operating system's SSH client must be configured to use only Message Authentication Codes (MACs) employing FIPS 140-3 validated cryptographic hash algorithms.
  resolution: "Configure the operating system's SSH client to use only MACs employing FIPS 140-3\n            approved algorithms by updating the \"/etc/ssh/ssh_config\" file with the following line:\n            MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-\n            512,hmac-sha2-256\n            Restart the \"ssh\" service for changes to take effect:\n            $ sudo systemctl restart ssh"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/ssh_config%' AND (line LIKE 'MACs hmac-sha2-512-etm@openssh%' OR line LIKE ' MACs hmac-sha2-512-etm@openssh%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100860, cis_category:Data Protection, cis_subcategory:Encrypt Sensitive Data in Transit, cis_safeguard_ids:CIS3.10
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.29 UBTU-24-100900 (Automated)
  platform: linux
  description: The operating system must accept personal identity verification (PIV) credentials.
  resolution: "Install the \"opensc-pkcs11\" package by using the following command:\n            $ sudo apt-get install opensc-pkcs11"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM deb_packages WHERE name='opensc-pkcs11');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100900, cis_category:Access Control Management, cis_subcategory:Require MFA for Administrative Access, cis_safeguard_ids:CIS6.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.30 UBTU-24-100910 (Automated)
  platform: linux
  description: The operating system must accept Personal Identity Verification (PIV) credentials managed through the Privileged Access Management (PAM) framework.
  resolution: "Install the \"libpam-pkcs11\" package by using the following command:\n            $ sudo apt-get install libpam-pkcs11"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM deb_packages WHERE name='libpam-pkcs11');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_100910, cis_category:Access Control Management, cis_subcategory:Require MFA for Administrative Access, cis_safeguard_ids:CIS6.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.31 UBTU-24-101000 (Automated)
  platform: linux
  description: The operating system must allow users to directly initiate a session lock for all connection types.
  resolution: "Install the \"vlock\" package by using the following command:\n            $ sudo apt-get install vlock\n\n\n\n\n                                                                                                Page 91\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM deb_packages WHERE name='vlock');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_101000, cis_category:Secure Configuration, cis_subcategory:Configure Automatic Session Locking on Enterprise, cis_safeguard_ids:CIS4.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.32 UBTU-24-102000 (Automated)
  platform: linux
  description: The operating system, when booted, must require authentication upon booting into single-user and maintenance modes.
  resolution: "Configure the operating system to require a password for authentication upon booting\n            into single-user and maintenance modes.\n            Generate an encrypted (grub) password for root by using the following command:\n            $ grub-mkpasswd-pbkdf2\n\n            Enter Password:\n            Reenter Password:\n            PBKDF2 hash of your password is\n            grub.pbkdf2.sha512.10000.03255F190F0E2F7B4F0D1C3216012309162F022A7A636771\n            Using the hash from the output, modify the \"/etc/grub.d/40_custom\" file by using the\n            following command to add a boot password:\n            $ sudo sed -i '$i set superusers=\\\"root\\\"\\npassword_pbkdf2 root <hash>'\n            /etc/grub.d/40_custom\n            where is the hash generated by grub-mkpasswd-pbkdf2 command.\n            Generate an updated \"grub.conf\" file with the new password by using the following\n            command:\n            $ sudo update-grub"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/boot/grub/grub.cfg' AND line LIKE '%password%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_102000, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.33 UBTU-24-102010 (Automated)
  platform: linux
  description: The operating system must initiate session audits at system startup.
  resolution: "Configure the operating system to produce audit records at system startup.\n            Edit the \"/etc/default/grub\" file and add \"audit=1\" to the \"GRUB_CMDLINE_LINUX\"\n            option.\n            GRUB_CMDLINE_LINUX=\"audit=1\"\n            To update the grub config file, run:\n            $ sudo update-grub\n\n\n\n\n                                                                                               Page 96\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/boot/grub/grub.cfg' AND line LIKE '%linux%' AND line LIKE '%audit=1%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_102010, cis_category:Access Control Management, cis_subcategory:Establish an Access Revoking Process, cis_safeguard_ids:CIS6.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.34 UBTU-24-200000 (Automated)
  platform: linux
  description: The operating system must limit the number of concurrent sessions to ten for all accounts and/or account types.
  resolution: "Configure the operating system to limit the number of concurrent sessions to 10 for all\n            accounts and/or account types.\n            Add or modify the following line at the top of the \"/etc/security/limits.conf\" file or in a\n            \".conf\" file defined in /etc/security/limits.d/:\n            * hard maxlogins 10\n\n\n\n\n                                                                                                  Page 98\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/security/limits.conf' AND line LIKE '%maxlogins%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200000, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.35 UBTU-24-200020 (Automated)
  platform: linux
  description: The operating system must initiate a graphical session lock after 15 minutes of inactivity.
  resolution: "Configure the operating system to lock the current graphical user interface session after\n            10 minutes of inactivity.\n            Set the following settings to allow graphical user interface session lock to initiate after\n            10 minutes of inactivity:\n            $ gsettings set org.gnome.desktop.screensaver lock-enabled true\n            $ gsettings set org.gnome.desktop.screensaver lock-delay 0\n            $ gsettings set org.gnome.desktop.session idle-delay 600"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/dconf/db/local.d/%' AND line LIKE '%idle-delay%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200020, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.36 UBTU-24-200040 (Automated)
  platform: linux
  description: The operating system must retain a user's session lock until that user reestablishes access using established identification and authentication procedures.
  resolution: "Configure the operating system to allow a user to lock the current graphical user\n            interface session.\n            Set the \"lock-enabled\" setting to allow graphical user interface session locks with the\n            following command:\n            $ gsettings set org.gnome.desktop.screensaver lock-enabled true\n\n\n\n\n                                                                                                  Page 102\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/dconf/db/local.d/%' AND line LIKE '%lock-enabled%' AND line LIKE '%true%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200040, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.37 UBTU-24-200060 (Automated)
  platform: linux
  description: The operating system must automatically terminate a user session after inactivity timeouts have expired.
  resolution: "Configure the operating system to automatically terminate a user session after inactivity\n            timeouts have expired or at shutdown.\n\n            Create the file \"/etc/profile.d/99-terminal_tmout.sh\" file if it does not exist.\n            Modify or append the following line in the \"/etc/profile.d/99-terminal_tmout.sh \" file:\n            TMOUT=600\n            This will set a timeout value of 10 minutes for all future sessions.\n\n            To set the timeout for the current sessions, execute the following command over the\n            terminal session:\n            $ export TMOUT=600"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path='/etc/profile.d/99-terminal_tmout.sh' OR path='/etc/bash.bashrc' OR path='/etc/profile') AND line LIKE 'TMOUT=%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200060, cis_category:Secure Configuration, cis_subcategory:Configure Automatic Session Locking on Enterprise, cis_safeguard_ids:CIS4.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.38 UBTU-24-200090 (Automated)
  platform: linux
  description: The operating system must monitor remote access methods.
  resolution: "Configure the operating system to monitor all remote access methods.\n            Add or modify the following line in the \"/etc/rsyslog.d/50-default.conf\" file:\n            auth.*,authpriv.* /var/log/secure\n            daemon.* /var/log/messages\n            Restart \"rsyslog.service\" for the changes to take effect by using the following command:\n            $ sudo systemctl restart rsyslog.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/rsyslog.d/%' OR path='/etc/rsyslog.conf') AND line LIKE '%auth.*%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200090, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.39 UBTU-24-200250 (Manual)
  platform: linux
  description: The operating system must automatically expire temporary accounts within 72 hours.
  resolution: "Configure the operating system to expire temporary accounts after 72 hours by using\n            the following command:\n            $ sudo chage -E $(date -d +3days +%Y-%m-%d) <temporary_account_name>"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/login.defs' AND line LIKE 'PASS_MAX_DAYS%' AND line NOT LIKE '#%');
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200250, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.40 UBTU-24-200260 (Automated)
  platform: linux
  description: The operating system must disable account identifiers (individuals, groups, roles, and devices) after 35 days of inactivity.
  resolution: "Configure the operating system to disable account identifiers after 35 days of inactivity\n            after the password expiration.\n            Run the following command to change the configuration for adduser:\n            $ sudo useradd -D -f 35\n            Note: DOD recommendation is 35 days, but a lower value is acceptable. The value \"0\"\n            will disable the account immediately after the password expires."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/default/useradd' AND line LIKE '%INACTIVE%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200260, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.41 UBTU-24-200280 (Automated)
  platform: linux
  description: The operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/passwd.
  resolution: "Configure the audit system to generate audit records for all account creations,\n            modifications, disabling, and termination events that affect \"/etc/passwd\".\n            Add or modify the following line to \"/etc/audit/rules.d/stig.rules\":\n            -w /etc/passwd -p wa -k usergroup_modification\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /etc/passwd%' AND line LIKE '%-p wa%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200280, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.42 UBTU-24-200290 (Automated)
  platform: linux
  description: The operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/group.
  resolution: "Configure the operating system to generate audit records for all account creations,\n            modifications, disabling, and termination events that affect \"/etc/group\".\n            Add or modify the following line to \"/etc/audit/rules.d/stig.rules\":\n            -w /etc/group -p wa -k usergroup_modification\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /etc/group%' AND line LIKE '%-p wa%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200290, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.43 UBTU-24-200300 (Automated)
  platform: linux
  description: The operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/shadow.
  resolution: "Configure the audit system to generate audit records for all account creations,\n            modifications, disabling, and termination events that affect \"/etc/shadow\".\n\n            Add or modify the following line to \"/etc/audit/rules.d/stig.rules\":\n            -w /etc/shadow -p wa -k usergroup_modification\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /etc/shadow%' AND line LIKE '%-p wa%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200300, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.44 UBTU-24-200310 (Automated)
  platform: linux
  description: The operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/gshadow.
  resolution: "Configure the audit system to generate audit records for all account creations,\n            modifications, disabling, and termination events that affect \"/etc/gshadow\".\n            Add or modify the following line to \"/etc/audit/rules.d/stig.rules\":\n            -w /etc/gshadow -p wa -k usergroup_modification\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /etc/gshadow%' AND line LIKE '%-p wa%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200310, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.45 UBTU-24-200320 (Automated)
  platform: linux
  description: The operating system must generate audit records for all account creations, modifications, disabling, and termination events that affect /etc/opasswd.
  resolution: "Configure the audit system to generate audit records for all account creations,\n            modifications, disabling, and termination events that affect \"/etc/security/opasswd\".\n            Add or modify the following line to \"/etc/audit/rules.d/stig.rules\":\n            -w /etc/security/opasswd -p wa -k usergroup_modification\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /etc/security/opasswd%' AND line LIKE '%-p wa%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200320, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.46 UBTU-24-200580 (Automated)
  platform: linux
  description: The operating system must prevent all software from executing at higher privilege levels than users executing the software and the audit system must be configured to audit the execution of privileged functions.
  resolution: "Configure the audit system to audit the execution of all privileged functions.\n            Add or modify the following lines in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -k execpriv\n            -a always,exit -F arch=b64 -S execve -C gid!=egid -F egid=0 -k execpriv\n            -a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -k execpriv\n            -a always,exit -F arch=b32 -S execve -C gid!=egid -F egid=0 -k execpriv\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-S execve%' AND line LIKE '%execpriv%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200580, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.47 UBTU-24-200610 (Automated)
  platform: linux
  description: The operating system must automatically lock an account until the locked account is released by an administrator when three unsuccessful logon attempts have been made.
  resolution: "Configure the operating system to utilize the \"pam_faillock\" module.\n            Add or modify the following lines in the \"/etc/pam.d/common-auth\" file, below the \"auth\"\n            definition for \"pam_unix.so\":\n            auth          [default=die]   pam_faillock.so authfail\n            auth          sufficient           pam_faillock.so authsucc\n            Configure the \"pam_faillock\" module to use the following options.\n            Add or modify the following lines in the \"/etc/security/faillock.conf\" file:\n            audit\n            silent\n            deny = 3\n            fail_interval = 900\n            unlock_time = 0"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/pam.d/common-auth' AND line LIKE '%faillock%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200610, cis_category:Access Control Management, cis_subcategory:Establish an Access Revoking Process, cis_safeguard_ids:CIS6.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.48 UBTU-24-200640 (Manual)
  platform: linux
  description: The operating system must display the Standard Mandatory DOD Notice and Consent Banner before granting local access to the system via a graphical user logon.
  resolution: "Configure the operating system to display the Standard Mandatory DOD Notice and\n            Consent Banner before granting access via an SSH logon.\n            Set the parameter Banner in \"/etc/ssh/sshd_config\" to point to the \"/etc/issue.net\" file:\n            $ sudo sed -i '/^Banner/d' /etc/ssh/sshd_config\n            $ sudo sed -i '$aBanner /etc/issue.net' /etc/ssh/sshd_config\n            Either create the file containing the banner or replace the text in the file with the\n            Standard Mandatory DOD Notice and Consent Banner. The DOD required text is:\n            \"You are accessing a U.S. Government (USG) Information System (IS) that is\n            provided for USG-authorized use only.\n\n            By using this IS (which includes any device attached to this IS), you consent\n            to the following conditions:\n\n            -The USG routinely intercepts and monitors communications on this IS for\n            purposes including, but not limited\
    \ to, penetration testing, COMSEC\n            monitoring, network operations and defense, personnel misconduct (PM), law\n            enforcement (LE), and counterintelligence (CI) investigations.\n\n            -At any time, the USG may inspect and seize data stored on this IS.\n\n            -Communications using, or data stored on, this IS are not private, are\n            subject to routine monitoring, interception, and search, and may be disclosed\n            or used for any USG-authorized purpose.\n\n            -This IS includes security measures (e.g., authentication and access\n            controls) to protect USG interests--not for your personal benefit or privacy.\n\n            -Notwithstanding the above, using this IS does not constitute consent to PM,\n            LE or CI investigative searching or monitoring of the content of privileged\n            communications, or work product, related to personal representation or\n            services by attorneys, psychotherapists,\
    \ or clergy, and their assistants.\n            Such communications and work product are private and confidential. See User\n            Agreement for details.\"\n            Restart the SSH daemon for the changes to take effect and then signal the SSH server\n            to reload the configuration file:\n            $ sudo systemctl -s SIGHUP kill sshd"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/sshd_config%' AND (line LIKE 'Banner %' OR line LIKE ' Banner %') AND line NOT LIKE '#%');
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200640, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.49 UBTU-24-200650 (Automated)
  platform: linux
  description: The operating system must enable the graphical user logon banner to display the Standard Mandatory DOD Notice and Consent Banner before granting local access to the system via a graphical user logon.
  resolution: "Configure the operating system to display the Standard Mandatory DOD Notice and\n            Consent Banner before granting access to the operating system via a graphical user\n            logon.\n            Add or modify the following line in the \"/etc/gdm3/greeter.dconf-defaults\" file:\n            [org/gnome/login-screen]\n            banner-message-enable=true\n            Update GDM with the new configuration by using the following commands:\n            $ sudo dconf update\n            $ sudo systemctl restart gdm3"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/gdm3/greeter.dconf-defaults' AND line LIKE 'banner-message-enable=true%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200650, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.50 UBTU-24-200660 (Manual)
  platform: linux
  description: The operating system must display the Standard Mandatory DOD Notice and Consent Banner before granting local access to the system via a graphical user logon.
  resolution: "Configure the operating system to display the Standard Mandatory DOD Notice and\n            Consent Banner before granting access to the operating system via a graphical user\n            logon.\n            Edit the \"/etc/gdm3/greeter.dconf-defaults\" file.\n            Set the \"banner-message-text\" line to contain the appropriate banner message text as\n            shown below:\n            banner-message-text='You are accessing a U.S. Government (USG) Information\n            System (IS) that is provided for USG-authorized use only.\\n\\nBy using this IS\n            (which includes any device attached to this IS), you consent to the following\n            conditions:\\n\\n-The USG routinely intercepts and monitors communications on\n            this IS for purposes including, but not limited to, penetration testing,\n            COMSEC monitoring, network operations and defense, personnel misconduct (PM),\n            law enforcement (LE), and counterintelligence (CI)\
    \ investigations.\\n\\n-At any\n            time, the USG may inspect and seize data stored on this IS.\\n\\n-\n            Communications using, or data stored on, this IS are not private, are subject\n            to routine monitoring, interception, and search, and may be disclosed or used\n            for any USG-authorized purpose.\\n\\n-This IS includes security measures (e.g.,\n            authentication and access controls) to protect USG interests--not for your\n            personal benefit or privacy.\\n\\n-Notwithstanding the above, using this IS\n            does not constitute consent to PM, LE or CI investigative searching or\n            monitoring of the content of privileged communications, or work product,\n            related to personal representation or services by attorneys,\n            psychotherapists, or clergy, and their assistants. Such communications and\n            work product are private and confidential. See User Agreement for details.'\n            Update\
    \ the GDM with the new configuration:\n            $ sudo dconf update\n            $ sudo systemctl restart gdm3"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/gdm3/greeter.dconf-defaults' AND line LIKE 'banner-message-text=%' AND line NOT LIKE '#%');
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200660, cis_category:General Information, cis_subcategory:General, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.51 UBTU-24-200680 (Manual)
  platform: linux
  description: Ubuntu 24.04 LTS must be configured to enforce the acknowledgement of the Standard Mandatory DOD Notice and Consent Banner for all SSH connections.
  resolution: "Configure Ubuntu 24.04 LTS to prompt a user to acknowledge the Standard Mandatory\n            DOD Notice and Consent Banner before granting access:\n            $ sudo vi /etc/profile.d/ssh_confirm.sh\n            #!/bin/bash\n\n            if [ -n \"$SSH_CLIENT\" ] || [ -n \"$SSH_TTY\" ]; then\n                    while true; do\n                            read -p \"\n\n            You are accessing a U.S. Government (USG) Information System (IS) that is\n            provided for USG-authorized use only.\n\n            By using this IS (which includes any device attached to this IS), you consent\n            to the following conditions:\n\n            -The USG routinely intercepts and monitors communications on this IS for\n            purposes including, but not limited to, penetration testing, COMSEC\n            monitoring, network operations and defense, personnel misconduct (PM), law\n            enforcement (LE), and counterintelligence (CI) investigations.\n\n  \
    \          -At any time, the USG may inspect and seize data stored on this IS.\n\n            -Communications using, or data stored on, this IS are not private, are\n            subject to routine monitoring, interception, and search, and may be disclosed\n            or used for any USG-authorized purpose.\n\n            -This IS includes security measures (e.g., authentication and access\n            controls) to protect USG interests--not for your personal benefit or privacy.\n\n            -Notwithstanding the above, using this IS does not constitute consent to PM,\n            LE or CI investigative searching or monitoring of the content of privileged\n            communications, or work product, related to personal representation or\n            services by attorneys, psychotherapists, or clergy, and their assistants.\n            Such communications and work product are private and confidential. See User\n            Agreement for details.\n\n            Do you agree? [y/N] \"\
    \ yn\n                            case $yn in\n                                     [Yy]* ) break ;;\n                                     [Nn]* ) exit 1 ;;\n                            esac\n                    done\n            fi\n            Note: The \"ssh_confirm.sh\" script is provided as a supplemental file to this document.\n\n\n\n\n                                                                                            Page 145\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/profile.d/ssh_confirm.sh');
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_200680, cis_category:General Information, cis_subcategory:General, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.52 UBTU-24-300001 (Automated)
  platform: linux
  description: The operating system must be configured so that the Advance Package Tool (APT) prevents the installation of patches, service packs, device drivers, or operating system components without verification they have been digitally signed using a certificate that is recognized and approved by the organization.
  resolution: "Configure APT to prevent the installation of patches, service packs, device drivers, or\n            Ubuntu 24.04 LTS components without verification they have been digitally signed using\n            a certificate recognized and approved by the organization.\n            Remove/update any APT configuration files that contain the variable\n            \"AllowUnauthenticated\" to \"false\" or remove \"AllowUnauthenticated\" entirely from each\n            file. Below is an example of setting the \"AllowUnauthenticated\" variable to \"false\":\n            APT::Get::AllowUnauthenticated \"false\";"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/apt/apt.conf.d/%' AND line LIKE '%AllowUnauthenticated%true%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300001, cis_category:Continuous Vulnerability Management, cis_subcategory:Perform Automated Operating System Patch, cis_safeguard_ids:CIS7.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.53 UBTU-24-300006 (Automated)
  platform: linux
  description: The operating system library files must have mode "755" or less permissive.
  resolution: "Configure the library files to be protected from unauthorized access. Run the following\n            command:\n            $ sudo find /lib /lib64 /usr/lib -perm /022 -type f -exec chmod 755 '{}' \\;"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE (path LIKE '/lib/%.so%' OR path LIKE '/usr/lib/%.so%') AND mode > '0755');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300006, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.54 UBTU-24-300007 (Automated)
  platform: linux
  description: The operating system library files must be owned by "root".
  resolution: "Configure the operating system library files to be protected from unauthorized access.\n            Run the following command:\n            $ sudo find /lib /usr/lib /lib64 ! -user root -type f -exec chown root '{}'\n            \\;"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE (path LIKE '/lib/%.so%' OR path LIKE '/usr/lib/%.so%') AND uid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300007, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.55 UBTU-24-300008 (Automated)
  platform: linux
  description: The operating system library directories must be owned by "root".
  resolution: "Configure the library files and their respective parent directories to be protected from\n            unauthorized access. Run the following command:\n            $ sudo find /lib /usr/lib /lib64 ! -user root -type d -exec chown root '{}'\n            \\;"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/lib','/usr/lib','/lib64') AND type='directory' AND uid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300008, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.56 UBTU-24-300009 (Automated)
  platform: linux
  description: The operating system library files must be group-owned by "root".
  resolution: "Configure the operating system library files to be protected from unauthorized access.\n            Run the following command, replacing \"[FILE]\" with any system command file not\n            group-owned by \"root\" or a required system account:\n            $ sudo chgrp root [FILE]"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE (path LIKE '/lib/%.so%' OR path LIKE '/usr/lib/%.so%') AND gid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300009, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.57 UBTU-24-300010 (Automated)
  platform: linux
  description: The operating system library directories must be group-owned by "root".
  resolution: "Configure the operating system library directories to be protected from unauthorized\n            access. Run the following command:\n            $ sudo find /lib /usr/lib /lib64 ! -group root -type d -exec chgrp root '{}'\n            \\;"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/lib','/usr/lib','/lib64') AND type='directory' AND gid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300010, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.58 UBTU-24-300011 (Automated)
  platform: linux
  description: The operating system must have system commands set to a mode of "755" or less permissive.
  resolution: "Configure the operating system commands to be protected from unauthorized access.\n            Run the following command:\n            $ sudo find /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin -\n            perm /022 -type f -exec chmod 755 '{}' \\;"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/bin','/sbin','/usr/bin','/usr/sbin') AND type='directory' AND mode > '0755');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300011, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.59 UBTU-24-300012 (Automated)
  platform: linux
  description: The operating system must have system commands owned by "root" or a system account.
  resolution: "Configure the system commands and their respective parent directories to be protected\n            from unauthorized access. Run the following command, replacing \"[FILE]\" with any\n            system command file not owned by \"root\" or a required system account:\n            $ sudo chown root [FILE]"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/bin','/sbin','/usr/bin','/usr/sbin','/usr/local/bin','/usr/local/sbin') AND type='directory' AND uid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300012, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.60 UBTU-24-300013 (Automated)
  platform: linux
  description: The operating system must have system commands group-owned by "root" or a system account.
  resolution: "Configure the operating system commands to be protected from unauthorized access.\n            Run the following command, replacing \"[FILE]\" with any system command file not\n            group-owned by \"root\" or a required system account:\n            $ sudo chgrp root [SYSTEMACCOUNT] [FILE]\n\n\n\n\n                                                                                             Page 163\n\nInternal Only - General"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/bin','/sbin','/usr/bin','/usr/sbin','/usr/local/bin','/usr/local/sbin') AND type='directory' AND gid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300013, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.61 UBTU-24-300014 (Automated)
  platform: linux
  description: The operating system must prevent the use of dictionary words for passwords.
  resolution: "Configure the operating system to prevent the use of dictionary words for passwords.\n            Add or modify the following line in the \"/etc/security/pwquality.conf\" file:\n            dictcheck = 1"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/security/pwquality.conf' AND (line LIKE 'dictcheck = 1%' OR line LIKE ' dictcheck = 1%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300014, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.62 UBTU-24-300016 (Automated)
  platform: linux
  description: The operating system must be configured so that when passwords are changed or new passwords are established, pwquality must be used.
  resolution: "Configure the operating system to use \"pwquality\" to enforce password complexity\n            rules.\n            Add or modify the following line in the \"/etc/security/pwquality.conf\" file:\n            enforcing = 1\n            Add or modify the following line in the \"/etc/pam.d/common-password\" file:\n            password requisite pam_pwquality.so retry=3\n            Note: The value of \"retry\" should be between \"1\" and \"3\".\n\n\n\n                                                                                                 Page 167\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/security/pwquality.conf' AND (line LIKE 'enforcing = 1%' OR line LIKE ' enforcing = 1%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300016, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.63 UBTU-24-300017 (Automated)
  platform: linux
  description: The operating system must enforce a delay of at least four seconds between logon prompts following a failed logon attempt.
  resolution: "Configure the operating system to enforce a delay of at least four seconds between\n            logon prompts following a failed logon attempt.\n            Add or modify the following line in the \"/etc/pam.d/common-auth\" file:\n            auth          required    pam_faildelay.so         delay=4000000"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/pam.d/common-auth' AND line LIKE '%pam_faildelay%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300017, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.64 UBTU-24-300021 (Automated)
  platform: linux
  description: The operating system must require users to reauthenticate for privilege escalation or when changing roles.
  resolution: "Remove any occurrence of \"NOPASSWD\" or \"!authenticate\" found in \"/etc/sudoers\" file\n            or files in the \"/etc/sudoers.d\" directory."
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file_lines WHERE (path='/etc/sudoers' OR path LIKE '/etc/sudoers.d/%') AND (line LIKE '%NOPASSWD%' OR line LIKE '%!authenticate%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300021, cis_category:Account Management, cis_subcategory:Restrict Administrator Privileges to Dedicated, cis_safeguard_ids:CIS5.4
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.65 UBTU-24-300022 (Automated)
  platform: linux
  description: The operating system must be configured so that remote X connections are disabled, unless to fulfill documented and validated mission requirements.
  resolution: "Configure the SSH server to disable X11 forwarding.\n            Add or modify the following line in the \"/etc/ssh/sshd_config\" file:\n            X11Forwarding no\n            Restart the SSH daemon for the changes to take effect:\n            $ sudo systemctl restart sshd.service\n\n\n\n\n                                                                                             Page 173\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/sshd_config%' AND (line LIKE 'X11Forwarding no%' OR line LIKE ' X11Forwarding no%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300022, cis_category:Secure Configuration, cis_subcategory:Uninstall or Disable Unnecessary Services on, cis_safeguard_ids:CIS4.8
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.66 UBTU-24-300023 (Automated)
  platform: linux
  description: The operating system SSH daemon must prevent remote hosts from connecting to the proxy display.
  resolution: "Configure the SSH server to prevent remote hosts from connecting to the proxy display.\n            Add or modify the following line in the \"/etc/ssh/sshd_config\" file:\n            X11UseLocalhost yes\n            Restart the SSH daemon for the changes to take effect:\n            $ sudo systemctl restart sshd.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/sshd_config%' AND (line LIKE 'X11UseLocalhost yes%' OR line LIKE ' X11UseLocalhost yes%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300023, cis_category:Secure Configuration, cis_subcategory:Uninstall or Disable Unnecessary Services on, cis_safeguard_ids:CIS4.8
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.67 UBTU-24-300024 (Automated)
  platform: linux
  description: Ubuntu 24.04 LTS must display the date and time of the last successful account logon upon logon.
  resolution: "Configure Ubuntu 24.04 LTS to provide users with feedback on when account accesses\n            last occurred by setting the required configuration options in \"/etc/pam.d/login\".\n            Add the following line to the top of \"/etc/pam.d/login\":\n            session        required         pam_lastlog.so showfailed"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/pam.d/login' AND line LIKE '%pam_lastlog%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300024, cis_category:General Information, cis_subcategory:General, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.68 UBTU-24-300025 (Automated)
  platform: linux
  description: The operating system must disable the x86 Ctrl-Alt-Delete key sequence if a graphical user interface is installed.
  resolution: "Configure the operating system to disable the Ctrl-Alt-Delete sequence when using a\n            graphical user interface:\n            $ gsettings set org.gnome.settings-daemon.plugins.media-keys logout []\n            Update the dconf settings:\n            $ sudo dconf update\n\n\n\n\n                                                                                                Page 178\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/dconf/db/local.d/%' AND line LIKE '%logout%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300025, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.69 UBTU-24-300026 (Automated)
  platform: linux
  description: The operating system must disable the x86 Ctrl-Alt-Delete key sequence.
  resolution: "Configure the system to disable the Ctrl-Alt-Delete sequence for the command line with\n            the following commands:\n            $ sudo systemctl disable ctrl-alt-del.target\n            [...]\n\n            $ sudo systemctl mask ctrl-alt-del.target\n            Created symlink /etc/systemd/system/ctrl-alt-del.target ? /dev/null.\n            Reload the daemon to take effect:\n            $ sudo systemctl daemon-reload\n\n\n\n\n                                                                                               Page 180\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM systemd_units WHERE id='ctrl-alt-del.service' AND (active_state='inactive' OR unit_file_state='masked' OR unit_file_state='disabled'));
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300026, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.70 UBTU-24-300027 (Automated)
  platform: linux
  description: The operating system must not have accounts configured with blank or null passwords.
  resolution: "Configure all accounts on the system to have a password or lock the account by using\n            the following commands:\n            Set the account password:\n            $ sudo passwd <username>\n            Or lock the account:\n            $ sudo passwd -l <username>"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM shadow WHERE password_status='NP');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300027, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.71 UBTU-24-300028 (Automated)
  platform: linux
  description: The operating system must not allow accounts configured in Pluggable Authentication Modules (PAM) with blank or null passwords.
  resolution: "If an account is configured for password authentication but does not have an assigned\n            password, it is possible to log on to the account without authenticating.\n            Remove any instances of the \"nullok\" option in \"/etc/pam.d/common-password\" to\n            prevent logons with empty passwords."
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/pam.d/common-auth' AND line LIKE '%nullok%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300028, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.72 UBTU-24-300029 (Automated)
  platform: linux
  description: The operating system must generate audit records for all events that affect the systemd journal files.
  resolution: "Configure the audit system to generate audit records for events that affect\n            \"/var/log/journal\".\n            Add or modify the following line to \"/etc/audit/rules.d/stig.rules\":\n            -w /var/log/journal -p wa -k systemd_journal\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                              Page 186\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /var/log/journal%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300029, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.73 UBTU-24-300030 (Automated)
  platform: linux
  description: The operating system default filesystem permissions must be defined in such a way that all authenticated users can read and modify only their own files.
  resolution: "Configure the operating system to define the default permissions for all authenticated\n            users in such a way that the user can read and modify only their own files.\n            Add or modify the following line in the \"/etc/login.defs\" file:\n            UMASK 077"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/login.defs' AND line LIKE 'UMASK%077%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300030, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.74 UBTU-24-300031 (Automated)
  platform: linux
  description: The operating system must not allow unattended or automatic login via SSH.
  resolution: "Configure the SSH server to not allow unattended or automatic login to the system.\n            Add or modify the following lines in the \"/etc/ssh/sshd_config\" file:\n            PermitEmptyPasswords no\n            PermitUserEnvironment no\n            Restart the SSH daemon for the changes to take effect:\n            $ sudo systemctl restart sshd.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/sshd_config%' AND (line LIKE 'PermitEmptyPasswords no%' OR line LIKE ' PermitEmptyPasswords no%') AND line NOT LIKE '#%') AND EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/sshd_config%' AND (line LIKE 'PermitUserEnvironment no%' OR line LIKE ' PermitUserEnvironment no%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300031, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.75 UBTU-24-300039 (Automated)
  platform: linux
  description: The operating system must disable automatic mounting of Universal Serial Bus (USB) mass storage driver.
  resolution: "Configure the operating system to disable using the USB storage kernel module.\n            Create and/or append a custom file under \"/etc/modprobe.d/\" to contain the following:\n            $ sudo su -c \"echo install usb-storage /bin/true >>\n            /etc/modprobe.d/DISASTIG.conf\"\n            Configure the operating system to disable the ability to use USB mass storage devices.\n            $ sudo su -c \"echo blacklist usb-storage >> /etc/modprobe.d/DISASTIG.conf\"\n\n\n\n\n                                                                                                  Page 192\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/modprobe.d/%' AND line LIKE '%usb-storage%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300039, cis_category:Network Monitoring and Defense, cis_subcategory:Manage USB Devices, cis_safeguard_ids:CIS13.7
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.76 UBTU-24-300041 (Manual)
  platform: linux
  description: The operating system must be configured to prohibit or restrict the use of functions, ports, protocols, and/or services, as defined in the PPSM CAL and vulnerability assessments.
  resolution: "Add all ports, protocols, or services allowed by the PPSM CLSA by using the following\n            command:\n            $ sudo ufw allow <direction> <port/protocol/service>\n            Where the direction is \"in\" or \"out\" and the port is the one corresponding to the protocol\n            or service allowed.\n            To deny access to ports, protocols, or services, use:\n            $ sudo ufw deny <direction> <port/protocol/service>"
  query: SELECT 1 FROM iptables WHERE (chain = 'INPUT' AND policy = 'ACCEPT') OR (chain = 'FORWARD' AND policy = 'ACCEPT') LIMIT 1;
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_300041, cis_category:Secure Configuration, cis_subcategory:Implement and Manage a Firewall on Servers, cis_safeguard_ids:CIS4.4
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.77 UBTU-24-400000 (Automated)
  platform: linux
  description: The operating system must uniquely identify interactive users.
  resolution: "Edit the file \"/etc/passwd\" and provide each interactive user account that has a duplicate\n            UID with a unique UID.\n\n\n\n\n                                                                                               Page 197\n\nInternal Only - General"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM users u1, users u2 WHERE u1.uid = u2.uid AND u1.username != u2.username AND u1.uid >= 1000);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400000, cis_category:General Information, cis_subcategory:Ensure root account is locked, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.78 UBTU-24-400020 (Automated)
  platform: linux
  description: Ubuntu 24.04 LTS must implement smart card logins for multifactor authentication for local and network access to privileged and nonprivileged accounts.
  resolution: "Configure Ubuntu 24.04 LTS to use multifactor authentication for access to accounts.\n            Add or update \"pam_pkcs11.so\" in \"/etc/pam.d/common-auth\" to match the following\n            line:\n            auth          [success=2 default=ignore] pam_pkcs11.so"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/pam.d/common-auth' AND line LIKE '%pam_pkcs11.so%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400020, cis_category:General Information, cis_subcategory:General, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.79 UBTU-24-400030 (Automated)
  platform: linux
  description: The operating system must implement smart card logins for multifactor authentication for local and network access to privileged and nonprivileged accounts over SSH.
  resolution: "Configure the operating system to use multifactor authentication for access to accounts.\n            Set the sshd option \"PubkeyAuthentication\" to \"yes\" in the \"/etc/ssh/sshd_config\" file.\n            PubkeyAuthentication yes"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/sshd_config%' AND (line LIKE 'PubkeyAuthentication yes%' OR line LIKE ' PubkeyAuthentication yes%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400030, cis_category:Access Control Management, cis_subcategory:Require MFA for Remote Network Access, cis_safeguard_ids:CIS6.4
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.80 UBTU-24-400060 (Automated)
  platform: linux
  description: The operating system must electronically verify personal identity verification (PIV) credentials.
  resolution: "Configure the operating system to do certificate status checking for multifactor\n            authentication.\n            Add or modify all \"cert_policy\" lines in the \"/etc/pam_pkcs11/pam_pkcs11.conf\" file with\n            the following:\n            ocsp_on"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/pam_pkcs11/pam_pkcs11.conf' AND line LIKE '%use_pkcs11_module%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400060, cis_category:Access Control Management, cis_subcategory:Require MFA for Administrative Access, cis_safeguard_ids:CIS6.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.81 UBTU-24-400110 (Automated)
  platform: linux
  description: The operating system must prevent direct login into the root account.
  resolution: "Configure the operating system to prevent direct logins to the root account by using the\n            following command:\n            $ sudo passwd -l root"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/shadow' AND line LIKE 'root:!%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400110, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.82 UBTU-24-400220 (Automated)
  platform: linux
  description: The operating system must store only encrypted representations of passwords.
  resolution: "Configure the operating system to store encrypted representations of passwords.\n            Add or modify the following line in the \"/etc/pam.d/common-password\" file:\n            password [success=1 default=ignore] pam_unix.so obscure sha512 shadow\n            remember=5 rounds=100000"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/pam.d/common-password' AND line LIKE '%pam_unix.so%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400220, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.83 UBTU-24-400260 (Automated)
  platform: linux
  description: The operating system must enforce password complexity by requiring at least one uppercase character be used.
  resolution: "Configure the operating system to enforce password complexity by requiring that at\n            least one uppercase character be used.\n            Add or modify the following line in the \"/etc/security/pwquality.conf\" file:\n            ucredit = -1"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/security/pwquality.conf' AND (line LIKE 'ucredit = -1%' OR line LIKE ' ucredit = -1%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400260, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.84 UBTU-24-400270 (Automated)
  platform: linux
  description: The operating system must enforce password complexity by requiring at least one lowercase character be used.
  resolution: "Configure the operating system to enforce password complexity by requiring that at\n            least one lowercase character be used.\n            Add or modify the following line in the \"/etc/security/pwquality.conf\" file:\n            lcredit = -1"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/security/pwquality.conf' AND (line LIKE 'lcredit = -1%' OR line LIKE ' lcredit = -1%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400270, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.85 UBTU-24-400280 (Automated)
  platform: linux
  description: The operating system must enforce password complexity by requiring that at least one numeric character be used.
  resolution: "Configure the operating system to enforce password complexity by requiring that at\n            least one numeric character be used.\n            Add or modify the following line in the \"/etc/security/pwquality.conf\" file:\n            dcredit = -1"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/security/pwquality.conf' AND (line LIKE 'dcredit = -1%' OR line LIKE ' dcredit = -1%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400280, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.86 UBTU-24-400290 (Automated)
  platform: linux
  description: The operating system must require the change of at least eight characters when passwords are changed.
  resolution: "Configure the operating system to require the change of at least eight characters when\n            passwords are changed.\n            Add or modify the following line in the \"/etc/security/pwquality.conf\" file:\n            difok = 8"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/security/pwquality.conf' AND (line LIKE 'difok = 8%' OR line LIKE ' difok = 8%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400290, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.87 UBTU-24-400300 (Automated)
  platform: linux
  description: The operating system must enforce 24 hours/one day as the minimum password lifetime. Passwords for new users must have a 24 hours/one day minimum password lifetime restriction.
  resolution: "Configure the operating system to enforce a 24 hours/one day minimum password\n            lifetime.\n            Add or modify the following line in the \"/etc/login.defs\" file:\n            PASS_MIN_DAYS        1"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/login.defs' AND line LIKE '%pass_min_days%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400300, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.88 UBTU-24-400310 (Automated)
  platform: linux
  description: The operating system must enforce a 60-day maximum password lifetime restriction. Passwords for new users must have a 60-day maximum password lifetime restriction.
  resolution: "Configure the operating system to enforce a 60-day maximum password lifetime.\n            Add or modify the following line in the \"/etc/login.defs\" file:\n            PASS_MAX_DAYS        60"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/login.defs' AND (line LIKE 'PASS_MAX_DAYS 60%' OR line LIKE ' PASS_MAX_DAYS 60%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400310, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.89 UBTU-24-400320 (Automated)
  platform: linux
  description: The operating system must enforce a minimum 15-character password length.
  resolution: "Configure the operating system to enforce a minimum 15-character password length.\n            Add or modify the following line in the \"/etc/security/pwquality.conf\" file:\n            minlen = 15"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/security/pwquality.conf' AND (line LIKE 'minlen = 15%' OR line LIKE ' minlen = 15%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400320, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.90 UBTU-24-400330 (Automated)
  platform: linux
  description: The operating system must enforce password complexity by requiring that at least one special character be used.
  resolution: "Configure the operating system to enforce password complexity by requiring that at\n            least one special character be used.\n            Add or modify the following line in the \"/etc/security/pwquality.conf\" file:\n            ocredit = -1"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/security/pwquality.conf' AND (line LIKE 'ocredit = -1%' OR line LIKE ' ocredit = -1%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400330, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.91 UBTU-24-400340 (Automated)
  platform: linux
  description: The operating system must be configured such that Pluggable Authentication Module (PAM) prohibits the use of cached authentications after one day.
  resolution: "Configure PAM to prohibit the use of cached authentications after one day.\n            Add or modify the following line in the \"/etc/sssd/sssd.conf\" file, just below the line\n            \"[pam]\":\n            offline_credentials_expiration = 1\n            Note: It is valid for this configuration to be in a file with a name that ends with \".conf\"\n            and does not begin with a \".\" in the \"/etc/sssd/conf.d/\" directory instead of the\n            \"/etc/sssd/sssd.conf\" file."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/sssd/sssd.conf' AND (line LIKE 'offline_credentials_expiration = 1%' OR line LIKE ' offline_credentials_expiration = 1%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400340, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.92 UBTU-24-400360 (Automated)
  platform: linux
  description: Ubuntu 24.04 LTS, for PKI-based authentication, SSSD must validate certificates by constructing a certification path (which includes status information) to an accepted trust anchor.
  resolution: "Configure Ubuntu 24.04 LTS, for PKI-based authentication, to validate certificates by\n            constructing a certification path to an accepted trust anchor.\n            Add or update the /etc/sssd/sssd.conf so that the following entries are in the correct\n            sections of the file:\n            $ sudo vi /etc/sssd/sssd.conf\n            [sssd]\n            services = nss,pam,ssh\n            config_file_version = 2\n\n            [pam]\n            pam_cert_auth = True\n\n            [domain/example.com]\n            ldap_user_certificate = usercertificate;binary\n            certificate_verification = ca_cert,ocsp\n            ca_cert = /etc/ssl/certs/ca-certificates.crt\n\n\n\n\n                                                                                                    Page 228\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/sssd/sssd.conf' AND line LIKE '%certificate_verification%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400360, cis_category:General Information, cis_subcategory:General, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.93 UBTU-24-400370 (Manual)
  platform: linux
  description: The operating system must map the authenticated identity to the user or group account for PKI-based authentication.
  resolution: "Configure sssd to map authenticated certificates to the appropriate user group by\n            adding the following line to the \"/etc/sssd/sssd.conf\" file:\n            ldap_user_certificate=userCertificate;binary"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/sssd/sssd.conf' AND line LIKE '%ldap_user_certificate%' AND line NOT LIKE '#%');
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400370, cis_category:Access Control Management, cis_subcategory:Require MFA for Administrative Access, cis_safeguard_ids:CIS6.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.94 UBTU-24-400375 (Automated)
  platform: linux
  description: The operating system, for PKI-based authentication, Privileged Access Management (PAM) must validate certificates by constructing a certification path (which includes status information) to an accepted trust anchor.
  resolution: "Configure the operating system for PKI-based authentication, to validate certificates by\n            constructing a certification path to an accepted trust anchor.\n            Add or modify all \"cert_policy\" lines in the \"/etc/pam_pkcs11/pam_pkcs11.conf\" file with\n            the following:\n            cert_policy = ca,signature,ocsp_on;\n            Note: If the system is missing an \"/etc/pam_pkcs11/\" directory and an\n            \"/etc/pam_pkcs11/pam_pkcs11.conf\", find an example to copy into place and modify\n            accordingly at \"/usr/share/doc/libpam-pkcs11/examples/pam_pkcs11.conf.example.gz\"."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/pam_pkcs11/pam_pkcs11.conf' AND line LIKE '%use_pkcs11_module%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400375, cis_category:Access Control Management, cis_subcategory:Require MFA for Administrative Access, cis_safeguard_ids:CIS6.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.95 UBTU-24-400380 (Automated)
  platform: linux
  description: The operating system for PKI-based authentication, must implement a local cache of revocation data in case of the inability to access revocation information via the network.
  resolution: "Configure the operating system, for PKI-based authentication, to use local revocation\n            data when unable to access the network to obtain it remotely.\n            Add or update the \"cert_policy\" option in \"/etc/pam_pkcs11/pam_pkcs11.conf\" to include\n            \"crl_auto\" or \"crl_offline\".\n            cert_policy = ca,signature,ocsp_on, crl_auto;\n            If the system is missing an \"/etc/pam_pkcs11/\" directory and an\n            \"/etc/pam_pkcs11/pam_pkcs11.conf\", find an example to copy into place and modify\n            accordingly at \"/usr/share/doc/libpam-pkcs11/examples/pam_pkcs11.conf.example.gz\"."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/pam_pkcs11/pam_pkcs11.conf' AND line LIKE '%cert_policy%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400380, cis_category:Access Control Management, cis_subcategory:Require MFA for Administrative Access, cis_safeguard_ids:CIS6.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.96 UBTU-24-400400 (Automated)
  platform: linux
  description: The operating system must encrypt all stored passwords with a FIPS 140-3-approved cryptographic hashing algorithm.
  resolution: "Configure the operating system to encrypt all stored passwords.\n            Add or modify the following line in the \"/etc/login.defs\" file:\n            ENCRYPT_METHOD SHA512"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/login.defs' AND (line LIKE 'ENCRYPT_METHOD SHA512%' OR line LIKE ' ENCRYPT_METHOD SHA512%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_400400, cis_category:Data Protection, cis_subcategory:Encrypt Sensitive Data at Rest, cis_safeguard_ids:CIS3.11
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.97 UBTU-24-500010 (Automated)
  platform: linux
  description: The operating system must generate audit records for privileged activities, nonlocal maintenance, diagnostic sessions and other system-level access.
  resolution: "Configure the audit system to audit activities performed during nonlocal maintenance\n            and diagnostic sessions.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -w /var/log/sudo.log -p wa -k maintenance\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /var/log/sudo.log%' AND line LIKE '%-p wa%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_500010, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.98 UBTU-24-500050 (Automated)
  platform: linux
  description: The operating system must use strong authenticators in establishing nonlocal maintenance and diagnostic sessions.
  resolution: "Configure the operating system to use strong authentication when establishing nonlocal\n            maintenance and diagnostic sessions.\n            Add or modify the following line to /etc/ssh/sshd_config:\n            UsePAM yes\n            Restart the SSH server for changes to take effect:\n            $ sudo systemctl restart sshd.service\n\n\n\n\n                                                                                               Page 242\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/sshd_config%' AND (line LIKE 'UsePAM yes%' OR line LIKE ' UsePAM yes%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_500050, cis_category:Account Management, cis_subcategory:Use Unique Passwords, cis_safeguard_ids:CIS5.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.99 UBTU-24-600000 (Automated)
  platform: linux
  description: The operating system must immediately terminate all network connections associated with SSH traffic after a period of inactivity.
  resolution: "Configure the SSH server to terminate a user session automatically after the SSH client\n            has become unresponsive.\n            Note: This setting must be applied in conjunction with UBTU-22-255040 to function\n            correctly.\n            Add or modify the following line in the \"/etc/ssh/sshd_config\" file:\n            ClientAliveCountMax 1\n            Restart the SSH daemon for the changes to take effect:\n            $ sudo systemctl restart sshd.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/sshd_config%' AND (line LIKE 'ClientAliveCountMax 1%' OR line LIKE ' ClientAliveCountMax 1%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600000, cis_category:General Information, cis_subcategory:General, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.100 UBTU-24-600010 (Automated)
  platform: linux
  description: The operating system must immediately terminate all network connections associated with SSH traffic at the end of the session or after 10 minutes of inactivity.
  resolution: "Configure the SSH server to terminate a user session automatically after the SSH client\n            has been unresponsive for 10 minutes.\n            Note: This setting must be applied in conjunction with UBTU-22-255040 to function\n            correctly.\n            Add or modify the following line in the \"/etc/ssh/sshd_config\" file:\n            ClientAliveInterval 600\n            Restart the SSH daemon for the changes to take effect:\n            $ sudo systemctl restart sshd.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/ssh/sshd_config%' AND (line LIKE 'ClientAliveInterval %' OR line LIKE 'clientaliveinterval %') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600010, cis_category:General Information, cis_subcategory:General, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.101 UBTU-24-600030 (Automated)
  platform: linux
  description: 'The operating system must implement NIST FIPS-validated cryptography to protect classified information and for the following: To provision digital signatures, to generate cryptographic hashes, and to protect unclassified information requiring confidentiality and cryptographic protection in accordance with applicable federal laws, Executive Orders, directives, policies, regulations, and standards.'
  resolution: "Configure the operating system to run in FIPS mode. Add \"fips=1\" to the kernel\n            parameter during the operating system install.\n            Enabling a FIPS mode on a pre-existing system involves a number of modifications to\n            the operating system. Refer to the Ubuntu Pro security certification documentation for\n            instructions.\n            A subscription to the \"Ubuntu Pro\" plan is required to obtain the FIPS Kernel\n            cryptographic modules and enable FIPS.\n            Note: Ubuntu Pro security certification instructions can be found at:\n            https://ubuntu.com/security/certifications/docs/fips-enablement\n            The basic steps use the following commands:\n            $ sudo pro attach <token>\n            $ sudo pro enable fips-updates\n\n\n\n                                                                                                Page 248\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM system_controls WHERE name='crypto.fips_enabled' AND current_value='1');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600030, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.102 UBTU-24-600060 (Automated)
  platform: linux
  description: The operating system must use DOD PKI-established certificate authorities for verification of the establishment of protected sessions.
  resolution: "Configure the operating system to use of DOD PKI-established certificate authorities for\n            verification of the establishment of protected sessions.\n            Edit the \"/etc/ca-certificates.conf\" file, adding the character \"!\" to the beginning of all\n            uncommented lines that do not start with the \"!\" character with the following command:\n            $ sudo sed -i -E 's/^([^!#]+)/!\\1/' /etc/ca-certificates.conf\n            Add at least one CA to the \"/usr/local/share/ca-certificates\" directory in the PEM format.\n            Update the \"/etc/ssl/certs\" directory with the following command:\n            $ sudo update-ca-certificates\n\n\n\n\n                                                                                                   Page 250\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path LIKE '/usr/local/share/ca-certificates/%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600060, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.103 UBTU-24-600070 (Automated)
  platform: linux
  description: The operating system must disable kernel core dumps so that it can fail to a secure state if system initialization fails, shutdown fails or aborts fail.
  resolution: "If kernel core dumps are not required, disable the \"kdump\" service with the following\n            command:\n            $ sudo systemctl disable kdump.service\n            If kernel core dumps are required, document the need with the ISSO."
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM systemd_units WHERE id='kdump.service' AND (active_state='active' OR unit_file_state='enabled'));
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600070, cis_category:Secure Configuration, cis_subcategory:Uninstall or Disable Unnecessary Services on, cis_safeguard_ids:CIS4.8
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.104 UBTU-24-600090 (Manual)
  platform: linux
  description: The operating system must implement cryptographic mechanisms to prevent unauthorized disclosure and modification of all information that requires protection at rest.
  resolution: "To encrypt an entire partition, dedicate a partition for encryption in the partition layout.\n            Note: Encrypting a partition in an already-installed system is more difficult because it will\n            need to be resized and existing partitions changed."
  query: SELECT 1 FROM mounts m, disk_encryption d WHERE m.device_alias = d.name AND d.encrypted = 0 AND m.path = '/' LIMIT 1;
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600090, cis_category:Data Protection, cis_subcategory:Encrypt Sensitive Data at Rest, cis_safeguard_ids:CIS3.11
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.105 UBTU-24-600130 (Manual)
  platform: linux
  description: The operating system must ensure only users who need access to security functions are part of sudo group.
  resolution: "Configure the sudo group with only members requiring access to security functions.\n            To remove a user from the sudo group, run:\n            $ sudo gpasswd -d <username> sudo"
  query: SELECT 1 FROM groups WHERE groupname='sudo';
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:1, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600130, cis_category:Account Management, cis_subcategory:Restrict Administrator Privileges to Dedicated, cis_safeguard_ids:CIS5.4
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.106 UBTU-24-600140 (Automated)
  platform: linux
  description: The operating system must restrict access to the kernel message buffer.
  resolution: "Configure the operating system to restrict access to the kernel message buffer.\n            Add or modify the following line in the \"/etc/sysctl.conf\" file:\n            kernel.dmesg_restrict = 1\n            Remove any configurations that conflict with the above from the following locations:\n            /run/sysctl.d/\n            /etc/sysctl.d/\n            /usr/local/lib/sysctl.d/\n            /usr/lib/sysctl.d/\n            /lib/sysctl.d/\n            /etc/sysctl.conf\n            Reload settings from all system configuration files by using the following command:\n            $ sudo sysctl --system"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM system_controls WHERE name='kernel.dmesg_restrict' AND current_value='1');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600140, cis_category:Secure Configuration, cis_subcategory:Uninstall or Disable Unnecessary Services on, cis_safeguard_ids:CIS4.8
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.107 UBTU-24-600150 (Automated)
  platform: linux
  description: The operating system must set a sticky bit on all public directories to prevent unauthorized and unintended information transferred via shared system resources.
  resolution: "Configure all public directories to have the sticky bit set to prevent unauthorized and\n            unintended information transferred via shared system resources.\n            Set the sticky bit on all public directories using the following command, replacing\n            \"<public_directory_name>\" with any directory path missing the sticky bit:\n            $ sudo chmod +t     <public_directory_name>\n\n\n\n\n                                                                                                  Page 261\n\nInternal Only - General"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/tmp', '/var/tmp') AND type='directory' AND mode NOT LIKE '1%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600150, cis_category:Secure Configuration, cis_subcategory:Establish and Maintain a Secure Configuration Process, cis_safeguard_ids:CIS4.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.108 UBTU-24-600160 (Automated)
  platform: linux
  description: The operating system must compare internal information system clocks at least every 24 hours with an authoritative time server.
  resolution: "Configure the operating system to compare the system clock at least every 24 hours to\n            the authoritative time source.\n            Add or modify the following line in the \"/etc/chrony/chrony.conf\" file:\n            server [source] iburst maxpoll = 16\n            Restart \"chrony.service\" for the changes to take effect by using the following command:\n            $ sudo systemctl restart chrony.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/chrony%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600160, cis_category:Audit Log Management, cis_subcategory:Standardize Time Synchronization, cis_safeguard_ids:CIS8.4
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.109 UBTU-24-600180 (Automated)
  platform: linux
  description: The operating system must synchronize internal information system clocks to the authoritative time source when the time difference is greater than one second.
  resolution: "Configure chrony to synchronize the internal system clocks to the authoritative source\n            when the time difference is greater than one second by doing the following:\n            Edit the \"/etc/chrony/chrony.conf\" file and add:\n            makestep 1 -1\n            Restart the chrony service:\n            $ sudo systemctl restart chrony.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/chrony%' AND (line LIKE 'makestep 1 -1%' OR line LIKE ' makestep 1 -1%') AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600180, cis_category:Audit Log Management, cis_subcategory:Standardize Time Synchronization, cis_safeguard_ids:CIS8.4
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.110 UBTU-24-600190 (Automated)
  platform: linux
  description: The operating system must be configured to use TCP syncookies.
  resolution: "Configure the operating system to use TCP syncookies by using the following\n            command:\n            $ sudo sysctl -w net.ipv4.tcp_syncookies=1\n            If \"1\" is not the system's default value, add or update the following line in\n            \"/etc/sysctl.conf\":\n            net.ipv4.tcp_syncookies = 1"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM system_controls WHERE name='net.ipv4.tcp_syncookies' AND current_value='1');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600190, cis_category:Secure Configuration, cis_subcategory:Uninstall or Disable Unnecessary Services on, cis_safeguard_ids:CIS4.8
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.112 UBTU-24-600230 (Automated)
  platform: linux
  description: The operating system must disable all wireless network adapters.
  resolution: "List all the wireless interfaces with the following command:\n            $ ls -L -d /sys/class/net/*/wireless | xargs dirname | xargs basename\n            For each interface, configure the system to disable wireless network interfaces with the\n            following command:\n            $ sudo ifdown <interface name>\n            For each interface listed, find their respective module with the following command:\n            $ basename $(readlink -f /sys/class/net/<interface name>/device/driver)\n            where must be substituted by the actual interface name.\n            Create a file in the \"/etc/modprobe.d\" directory and for each module, add the following\n            line:\n            install <module name> /bin/true\n            For each module from the system, execute the following command to remove it:\n            $ sudo modprobe -r <module name>"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path LIKE '/sys/class/net/%/wireless' AND type='directory');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_600230, cis_category:Secure Configuration, cis_subcategory:Uninstall or Disable Unnecessary Services on, cis_safeguard_ids:CIS4.8
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.113 UBTU-24-700010 (Automated)
  platform: linux
  description: The operating system must generate error messages that provide information necessary for corrective actions without revealing information that could be exploited by adversaries.
  resolution: "Configure the operating system to set permissions of all log files under the \"/var/log\"\n            directory to \"640\" or more restricted by using the following command:\n            Note: The btmp, wtmp, and lastlog files are excluded. Refer to the Discussion for\n            details.\n            $ sudo find /var/log -perm /137 ! -name '*[bw]tmp' ! -name '*lastlog' -type f\n            -exec chmod 640 '{}' \\;"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path LIKE '/var/log/%' AND type='regular' AND mode > '0640' AND filename NOT LIKE 'btmp%' AND filename NOT LIKE 'wtmp%' AND filename NOT LIKE 'lastlog%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700010, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.114 UBTU-24-700020 (Automated)
  platform: linux
  description: The operating system must generate system journal entries without revealing information that could be exploited by adversaries.
  resolution: "Configure the operating system to set the appropriate permissions to the files and\n            directories used by the systemd journal:\n            Add or modify the following lines in the \"/usr/lib/tmpfiles.d/systemd.conf\" file:\n            z /run/log/journal 2750 root systemd-journal - -\n            Z /run/log/journal/%m ~2750 root systemd-journal - -\n            z /var/log/journal 2750 root systemd-journal - -\n            z /var/log/journal/%m 2750 root systemd-journal - -\n            z /var/log/journal/%m/system.journal 0750 root systemd-journal - -\n            Restart the system for the changes to take effect."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/run/log/journal' AND mode <= '02750');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700020, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.115 UBTU-24-700030 (Automated)
  platform: linux
  description: The operating system must be configured so that the "journalctl" command is not accessible by unauthorized users.
  resolution: "Configure \"journalctl\" to have a permission set of \"740\":\n            $ sudo chmod 740 /usr/bin/journalctl\n\n\n\n\n                                                                                             Page 280\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/usr/bin/journalctl' AND mode <= '0750');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700030, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.116 UBTU-24-700040 (Automated)
  platform: linux
  description: The operating system must be configured so that the "journalctl" command is owned by "root".
  resolution: "Configure \"journalctl\" to be owned by \"root\":\n            $ sudo chown root /usr/bin/journalctl"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/usr/bin/journalctl' AND uid=0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700040, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.117 UBTU-24-700050 (Automated)
  platform: linux
  description: The operating system must be configured so that the "journalctl" command is group- owned by "root".
  resolution: "Configure \"journalctl\" to be group-owned by \"root\":\n            $ sudo chown :root /usr/bin/journalctl"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/usr/bin/journalctl' AND gid=0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700050, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.118 UBTU-24-700060 (Automated)
  platform: linux
  description: The operating system must configure the directories used by the system journal to be group-owned by "systemd-journal".
  resolution: "Configure the operating system to set the appropriate group-ownership to the\n            directories used by the systemd journal:\n            Add or modify the following lines in the \"/usr/lib/tmpfiles.d/systemd.conf\" file:\n            z /run/log/journal 2640 root systemd-journal - -\n            z /var/log/journal 2640 root systemd-journal - -\n            Restart the system for the changes to take effect.\n\n\n\n\n                                                                                                 Page 286\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/run/log/journal' AND type='directory' AND gid=(SELECT gid FROM groups WHERE groupname='systemd-journal'));
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700060, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.119 UBTU-24-700070 (Automated)
  platform: linux
  description: The operating system must configure the files used by the system journal to be group- owned by "systemd-journal".
  resolution: "Configure the operating system to set the appropriate group-ownership to the files used\n            by the systemd journal:\n            Add or modify the following line in the \"/usr/lib/tmpfiles.d/systemd.conf\" file:\n            Z /run/log/journal/%m ~2640 root systemd-journal - -\n            z /var/log/journal/%m 2640 root systemd-journal - -\n            z /var/log/journal/%m/system.journal 0640 root systemd-journal - -\n            Restart the system for the changes to take effect."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/var/log/journal' AND type='directory' AND gid=(SELECT gid FROM groups WHERE groupname='systemd-journal'));
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700070, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.120 UBTU-24-700080 (Automated)
  platform: linux
  description: The operating system must configure the directories used by the system journal to be owned by "root".
  resolution: "Configure the operating system to set the appropriate ownership to the directories used\n            by the systemd journal:\n            Add or modify the following lines in the \"/usr/lib/tmpfiles.d/systemd.conf\" file:\n            z /run/log/journal 2640 root systemd-journal - -\n            z /var/log/journal 2640 root systemd-journal - -\n            Restart the system for the changes to take effect.\n\n\n\n\n                                                                                               Page 290\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/run/log/journal' AND type='directory' AND uid=0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700080, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.121 UBTU-24-700090 (Automated)
  platform: linux
  description: The operating system must configure the files used by the system journal to be owned by "root".
  resolution: "Configure the operating system to set the appropriate ownership to the files used by the\n            systemd journal:\n            Add or modify the following lines in the \"/usr/lib/tmpfiles.d/systemd.conf\" file:\n            Z /run/log/journal/%m ~2640 root systemd-journal - -\n            z /var/log/journal/%m 2640 root systemd-journal - -\n            z /var/log/journal/%m/system.journal 0640 root systemd-journal - -\n            Restart the system for the changes to take effect."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/var/log/journal' AND type='directory' AND uid=0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700090, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.122 UBTU-24-700100 (Automated)
  platform: linux
  description: The operating system must configure the "/var/log" directory to be group-owned by "syslog".
  resolution: "Configure the operating system to have syslog group-own the \"/var/log\" directory by\n            using the following command:\n            $ sudo chgrp syslog /var/log"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/var/log' AND gid=(SELECT gid FROM groups WHERE groupname='syslog'));
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700100, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.123 UBTU-24-700110 (Automated)
  platform: linux
  description: The operating system must configure the "/var/log" directory to be owned by "root".
  resolution: "Configure the operating system to have root own the \"/var/log\" directory by using the\n            following command:\n            $ sudo chown root /var/log"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/var/log' AND uid=0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700110, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.124 UBTU-24-700120 (Automated)
  platform: linux
  description: 'The operating system must configure the "/var/log" directory to have mode "755" or less permissive. ROUP ID: V-270767 RULE ID: SV-270767r1066790'
  resolution: "Configure the \"/var/log\" directory to have permissions of \"0755\" by using the following\n            command:\n            $ sudo chmod 0755 /var/log\n\n\n\n\n                                                                                              Page 298\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/var/log' AND mode <= '0755');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700120, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.125 UBTU-24-700130 (Automated)
  platform: linux
  description: The operating system must configure the "/var/log/syslog" file to be group-owned by "adm".
  resolution: "Configure the operating system to have adm group-own the \"/var/log/syslog\" file by\n            using the following command:\n            $ sudo chgrp adm /var/log/syslog"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/var/log/syslog' AND gid=(SELECT gid FROM groups WHERE groupname='adm'));
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700130, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.126 UBTU-24-700140 (Automated)
  platform: linux
  description: The operating system must configure "/var/log/syslog" file to be owned by "syslog".
  resolution: "Configure the operating system to have syslog own the \"/var/log/syslog\" file by using the\n            following command:\n            $ sudo chown syslog /var/log/syslog"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/var/log/syslog' AND uid=(SELECT uid FROM users WHERE username='syslog'));
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700140, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.127 UBTU-24-700150 (Automated)
  platform: linux
  description: The operating system must configure "/var/log/syslog" file with mode "640" or less permissive.
  resolution: "Configure the operating system to have permissions of \"640\" for the \"/var/log/syslog\" file\n            by using the following command:\n            $ sudo chmod 0640 /var/log/syslog"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/var/log/syslog' AND mode <= '0640');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700150, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.128 UBTU-24-700300 (Manual)
  platform: linux
  description: The operating system must implement nonexecutable data to protect its memory from unauthorized code execution.
  resolution: "Configure the operating system to enable NX.\n            If \"nx\" is not showing up in \"/proc/cpuinfo\", and the system's BIOS setup configuration\n            permits toggling the No Execution bit, set it to \"enable\".\n\n\n\n\n                                                                                                Page 306\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/proc/cpuinfo' AND line LIKE '%flags%' AND line NOT LIKE '#%');
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700300, cis_category:Malware Defenses, cis_subcategory:Enable Anti-Exploitation Features, cis_safeguard_ids:CIS10.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.129 UBTU-24-700310 (Automated)
  platform: linux
  description: The operating system must implement address space layout randomization to protect its memory from unauthorized code execution.
  resolution: "Remove the \"kernel.randomize_va_space\" entry found in the \"/etc/sysctl.conf\" file or\n            any file located in the \"/etc/sysctl.d/\" directory.\n            After the line has been removed, the kernel settings from all system configuration files\n            must be reloaded before any of the changes will take effect. Run the following\n            command to reload all of the kernel system configuration files:\n            $ sudo sysctl --system"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM system_controls WHERE name='kernel.randomize_va_space' AND current_value='2');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700310, cis_category:Malware Defenses, cis_subcategory:Enable Anti-Exploitation Features, cis_safeguard_ids:CIS10.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.130 UBTU-24-700320 (Automated)
  platform: linux
  description: The operating system must be configured so that the Advance Package Tool (APT) removes all software components after updated versions have been installed.
  resolution: "Configure APT to remove all software components after updated versions have been\n            installed.\n            Add or modify the following lines in the \"/etc/apt/apt.conf.d/50unattended-upgrades\" file:\n            Unattended-Upgrade::Remove-Unused-Kernel-Packages \"true\";\n            Unattended-Upgrade::Remove-Unused-Dependencies \"true\";"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/apt/apt.conf.d/50unattended-upgrades' AND line LIKE '%remove-unused%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700320, cis_category:General Information, cis_subcategory:General, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.131 UBTU-24-700400 (Manual)
  platform: linux
  description: Ubuntu 24.04 LTS must be a vendor-supported release.
  resolution: Upgrade to a supported version of Ubuntu 24.04 LTS.
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/lsb-release' AND line LIKE '%DISTRIB_DESCRIPTION%' AND line NOT LIKE '#%');
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_700400, cis_category:General Information, cis_subcategory:General, cis_safeguard_ids:CISNone
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.132 UBTU-24-900040 (Automated)
  platform: linux
  description: The operating system must be configured so that audit configuration files are not write- accessible by unauthorized users.
  resolution: "Configure \"/etc/audit/audit.rules\", \"/etc/audit/auditd.conf\", and \"/etc/audit/rules.d/*\" files\n            to have a mode of \"640\" by using the following command:\n            $ sudo chmod -R 0640 /etc/audit/audit*.{rules,conf} /etc/audit/rules.d/*\n\n\n\n\n                                                                                                   Page 312\n\nInternal Only - General"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules' OR path='/etc/audit/auditd.conf') AND mode > '0640');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900040, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.133 UBTU-24-900050 (Automated)
  platform: linux
  description: The operating system must permit only authorized accounts to own the audit configuration files.
  resolution: "Configure \"/etc/audit/audit.rules\", \"/etc/audit/rules.d/*\", and \"/etc/audit/auditd.conf\" files\n            to be owned by root by using the following command:\n            $ sudo chown root /etc/audit/audit*.{rules,conf} /etc/audit/rules.d/*\n\n\n\n\n                                                                                                     Page 314\n\nInternal Only - General"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules' OR path='/etc/audit/auditd.conf') AND uid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900050, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.134 UBTU-24-900060 (Automated)
  platform: linux
  description: The operating system must permit only authorized groups to own the audit configuration files.
  resolution: "Configure \"/etc/audit/audit.rules\", \"/etc/audit/rules.d/*\", and \"/etc/audit/auditd.conf\" files\n            to be owned by root group by using the following command:\n            $ sudo chown :root /etc/audit/audit*.{rules,conf} /etc/audit/rules.d/*\n\n\n\n\n                                                                                                     Page 316\n\nInternal Only - General"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules' OR path='/etc/audit/auditd.conf') AND gid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900060, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.135 UBTU-24-900070 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the su command.
  resolution: "Configure the audit system to generate audit records when successful/unsuccessful\n            attempts to use the \"su\" command occur.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/bin/su -F perm=x -F auid>=1000 -F auid!=-1 -k\n            privileged-priv_change\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 318\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/bin/su %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900070, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.136 UBTU-24-900080 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the chfn command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            uses of the \"chfn\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/chfn -F perm=x -F auid>=1000 -F auid!=-1 -k\n            privileged-chfn\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 320\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/chfn %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900080, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.137 UBTU-24-900090 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the mount command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"mount\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/mount -F perm=x -F auid>=1000 -F auid!=-1 -k\n            privileged-mount\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 322\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/mount %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900090, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.138 UBTU-24-900100 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the umount command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"umount\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/umount -F perm=x -F auid>=1000 -F auid!=-1 -k\n            privileged-umount\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 324\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/umount %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900100, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.139 UBTU-24-900110 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the ssh-agent command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"ssh-agent\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/ssh-agent -F perm=x -F auid>=1000 -F auid!=-1\n            -k privileged-ssh\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 326\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/ssh-agent %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900110, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.140 UBTU-24-900120 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the ssh-keysign command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"ssh-keysign\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/lib/openssh/ssh-keysign -F perm=x -F auid>=1000 -\n            F auid!=-1 -k privileged-ssh\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 328\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/lib/openssh/ssh-keysign %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900120, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.141 UBTU-24-900130 (Automated)
  platform: linux
  description: The operating system must generate audit records for any use of the setxattr, fsetxattr, lsetxattr, removexattr, fremovexattr, and lremovexattr system calls.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"setxattr\", \"fsetxattr\", \"lsetxattr\", \"removexattr\", \"fremovexattr\", and\n            \"lremovexattr\" system calls.\n            Add or modify the following lines in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F arch=b32 -S\n            setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F\n            auid>=1000 -F auid!=-1 -k perm_mod\n            -a always,exit -F arch=b32 -S\n            setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid=0\n            -k perm_mod\n            -a always,exit -F arch=b64 -S\n            setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F\n            auid>=1000 -F auid!=-1 -k perm_mod\n            -a always,exit -F arch=b64 -S\n            setxattr,fsetxattr,lsetxattr,removexattr,fremovexattr,lremovexattr -F auid=0\n            -k perm_mod\n\
    \            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-S %' AND (line LIKE '%setxattr%' OR line LIKE '%lsetxattr%' OR line LIKE '%fsetxattr%'));
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900130, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.142 UBTU-24-900140 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the chown, fchown, fchownat, and lchown system calls.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"chown\", \"fchown\", \"fchownat\", and \"lchown\" system calls.\n            Add or modify the following lines in the \"/etc/audit/rules.d/stig.rules\":\n            -a always,exit -F arch=b32 -S chown,fchown,fchownat,lchown -F auid>=1000 -F\n            auid!=-1 -k perm_chng\n            -a always,exit -F arch=b64 -S chown,fchown,fchownat,lchown -F auid>=1000 -F\n            auid!=-1 -k perm_chng\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-S %' AND (line LIKE '%chown%' OR line LIKE '%fchown%' OR line LIKE '%lchown%'));
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900140, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.143 UBTU-24-900150 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the chmod, fchmod, and fchmodat system calls.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"chmod\", \"fchmod\", and \"fchmodat\" system calls.\n            Add or modify the following lines in the \"/etc/audit/rules.d/stig.rules\":\n            -a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid>=1000 -F auid!=-1\n            -k perm_chng\n            -a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid>=1000 -F auid!=-1\n            -k perm_chng\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-S %' AND (line LIKE '%chmod%' OR line LIKE '%fchmod%'));
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900150, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.144 UBTU-24-900160 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the creat, open, openat, open_by_handle_at, truncate, and ftruncate system calls.
  resolution: "Configure the audit system to generate an audit event for any unsuccessful use of the\n            \"creat\", \"open\", \"openat\", \"open_by_handle_at\", \"truncate\", and \"ftruncate\" system calls.\n            Add or modify the following lines in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F arch=b32 -S\n            creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EPERM -F\n            auid>=1000 -F auid!=-1 -k perm_access\n            -a always,exit -F arch=b32 -S\n            creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EACCES -F\n            auid>=1000 -F auid!=-1 -k perm_access\n            -a always,exit -F arch=b64 -S\n            creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EPERM -F\n            auid>=1000 -F auid!=-1 -k perm_access\n            -a always,exit -F arch=b64 -S\n            creat,open,openat,open_by_handle_at,truncate,ftruncate -F exit=-EACCES -F\n            auid>=1000\
    \ -F auid!=-1 -k perm_access\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path LIKE '/etc/audit/rules.d/%' AND line LIKE '%-S creat%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900160, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.145 UBTU-24-900170 (Automated)
  platform: linux
  description: The operating system LTS must generate audit records for successful/unsuccessful uses of the sudo command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"sudo\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/sudo -F perm=x -F auid>=1000 -F auid!=-1 -k\n            priv_cmd\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 340\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/sudo %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900170, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.146 UBTU-24-900180 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the sudoedit command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"sudoedit\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\":\n            -a always,exit -F path=/usr/bin/sudoedit -F perm=x -F auid>=1000 -F auid!=-1\n            -k priv_cmd\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 342\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/sudoedit %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900180, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.147 UBTU-24-900190 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the chsh command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"chsh\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/chsh -F perm=x -F auid>=1000 -F auid!=-1 -k\n            priv_cmd\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n                                                                                                  Page 344\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/chsh %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900190, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.148 UBTU-24-900200 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the newgrp command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"newgrp\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/newgrp -F perm=x -F auid>=1000 -F auid!=-1 -k\n            priv_cmd\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 346\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/newgrp %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900200, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.149 UBTU-24-900210 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the chcon command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"chcon\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=1000 -F auid!=-1 -k\n            perm_chng\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 348\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/chcon %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900210, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.150 UBTU-24-900220 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the apparmor_parser command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"apparmor_parser\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/sbin/apparmor_parser -F perm=x -F auid>=1000 -F\n            auid!=-1 -k perm_chng\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n\n                                                                                              Page 350\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/sbin/apparmor_parser %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900220, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.151 UBTU-24-900230 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the setfacl command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"setfacl\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/setfacl -F perm=x -F auid>=1000 -F auid!=-1 -\n            k perm_chng\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 352\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/setfacl %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900230, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.152 UBTU-24-900240 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the chacl command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"chacl\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/chacl -F perm=x -F auid>=1000 -F auid!=-1 -k\n            perm_chng\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 354\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/chacl %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900240, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.153 UBTU-24-900250 (Automated)
  platform: linux
  description: The operating system must generate audit records for the use and modification of faillog file.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            modifications to the \"faillog\" file.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -w /var/log/faillog -p wa -k logins\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n                                                                                                 Page 356\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /var/log/faillog%' AND line LIKE '%-p wa%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900250, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.154 UBTU-24-900260 (Automated)
  platform: linux
  description: The operating system must generate audit records for the use and modification of the lastlog file.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            modifications to the \"lastlog\" file.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -w /var/log/lastlog -p wa -k logins\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n                                                                                                 Page 358\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /var/log/lastlog%' AND line LIKE '%-p wa%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900260, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.155 UBTU-24-900270 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the passwd command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            uses of the \"passwd\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/passwd -F perm=x -F auid>=1000 -F auid!=unset\n            -k privileged-passwd\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n                                                                                                 Page 360\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/passwd %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900270, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.156 UBTU-24-900280 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the unix_update command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            uses of the \"unix_update\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/sbin/unix_update -F perm=x -F auid>=1000 -F auid!=-1\n            -k privileged-unix-update\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 362\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/sbin/unix_update %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900280, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.157 UBTU-24-900290 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the gpasswd command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            uses of the \"gpasswd\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/gpasswd -F perm=x -F auid>=1000 -F auid!=-1 -\n            k privileged-gpasswd\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 364\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/gpasswd %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900290, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.158 UBTU-24-900300 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the chage command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            uses of the \"chage\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/chage -F perm=x -F auid>=1000 -F auid!=-1 -k\n            privileged-chage\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 366\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/chage %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900300, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.159 UBTU-24-900310 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the usermod command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            uses of the \"usermod\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/sbin/usermod -F perm=x -F auid>=1000 -F\n            auid!=unset -k privileged-usermod\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 368\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/sbin/usermod %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900310, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.160 UBTU-24-900320 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the crontab command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            uses of the \"crontab\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/bin/crontab -F perm=x -F auid>=1000 -F auid!=-1 -\n            k privileged-crontab\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 370\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/bin/crontab %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900320, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.161 UBTU-24-900330 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the pam_timestamp_check command.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            uses of the \"pam_timestamp_check\" command.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F path=/usr/sbin/pam_timestamp_check -F perm=x -F auid>=1000\n            -F auid!=-1 -k privileged-pam_timestamp_check\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n                                                                                                 Page 372\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-a always,exit%' AND line LIKE '%path=/usr/sbin/pam_timestamp_check %' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900330, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.162 UBTU-24-900340 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the init_module and finit_module system calls.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"init_module\" and \"finit_module\" syscalls.\n            Add or modify the following lines in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F arch=b32 -S init_module,finit_module -F auid>=1000 -F\n            auid!=-1 -k module_chng\n            -a always,exit -F arch=b64 -S init_module,finit_module -F auid>=1000 -F\n            auid!=-1 -k module_chng\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-S %' AND (line LIKE '%init_module%' OR line LIKE '%finit_module%'));
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900340, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.163 UBTU-24-900350 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful uses of the delete_module system call.
  resolution: "Configure the audit system to generate an audit event for any successful/unsuccessful\n            use of the \"delete_module\" syscall.\n            Add or modify the following lines in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F arch=b32 -S delete_module -F auid>=1000 -F auid!=-1 -k\n            module_chng\n            -a always,exit -F arch=b64 -S delete_module -F auid>=1000 -F auid!=-1 -k\n            module_chng\n\n\n\n\n                                                                                                 Page 376\n\nInternal Only - General\n\f            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-S delete_module%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900350, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.164 UBTU-24-900510 (Automated)
  platform: linux
  description: The operating system must generate audit records when successful/unsuccessful attempts to modify the /etc/sudoers file occur.
  resolution: "Configure the audit system to generate audit records for all modifications that affect\n            \"/etc/sudoers\".\n            Add or modify the following line to \"/etc/audit/rules.d/stig.rules\":\n            -w /etc/sudoers -p wa -k privilege_modification\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n\n                                                                                                 Page 378\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /etc/sudoers%' AND line LIKE '%-p wa%' AND line NOT LIKE '%sudoers.d%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900510, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.165 UBTU-24-900520 (Automated)
  platform: linux
  description: The operating system must generate audit records when successful/unsuccessful attempts to modify the /etc/sudoers.d directory occur.
  resolution: "Configure the audit system to generate audit records for all modifications that affect\n            \"/etc/sudoers.d\" directory.\n            Add or modify the following line to \"/etc/audit/rules.d/stig.rules\":\n            -w /etc/sudoers.d -p wa -k privilege_modification\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. he does not need to match the example above.\n\n\n\n\n                                                                                                 Page 380\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /etc/sudoers.d%' AND line LIKE '%-p wa%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900520, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.166 UBTU-24-900540 (Automated)
  platform: linux
  description: The operating system must generate audit records for any successful/unsuccessful use of unlink, unlinkat, rename, renameat, and rmdir system calls.
  resolution: "Configure the audit system to generate audit events for any successful/unsuccessful\n            use of \"unlink\", \"unlinkat\", \"rename\", \"renameat\", and \"rmdir\" system calls.\n            Add or modify the following lines in the \"/etc/audit/rules.d/stig.rules\" file:\n            -a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat,rmdir -F\n            auid>=1000 -F auid!=-1 -F key=delete\n            -a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat,rmdir -F\n            auid>=1000 -F auid!=-1 -F key=delete\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-S %' AND (line LIKE '%unlink%' OR line LIKE '%rename%'));
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900540, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.167 UBTU-24-900590 (Automated)
  platform: linux
  description: The operating system must generate audit records for the /var/log/wtmp file.
  resolution: "Configure the audit system to generate audit events showing start and stop times for\n            user access via the \"/var/log/wtmp\" file.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -w /var/log/wtmp -p wa -k logins\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /var/log/wtmp%' AND line LIKE '%-p wa%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900590, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.168 UBTU-24-900600 (Automated)
  platform: linux
  description: The operating system must generate audit records for the /var/run/utmp file.
  resolution: "Configure the audit system to generate audit events showing start and stop times for\n            user access via the \"/var/run/utmp\" file.\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -w /var/run/utmp -p wa -k logins\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /var/run/utmp%' AND line LIKE '%-p wa%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900600, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.169 UBTU-24-900610 (Automated)
  platform: linux
  description: The operating system must generate audit records for the /var/log/btmp file.
  resolution: "Configure the audit system to generate audit events showing start and stop times for\n            user access via the \"/var/log/btmp file\".\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -w /var/log/btmp -p wa -k logins\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /var/log/btmp%' AND line LIKE '%-p wa%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900610, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.170 UBTU-24-900730 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful attempts to use modprobe command.
  resolution: "Configure the operating system to audit the execution of the module management\n            program \"modprobe\".\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -w /sbin/modprobe -p x -k modules\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n\n                                                                                                 Page 390\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /sbin/modprobe%' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900730, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.171 UBTU-24-900740 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful attempts to use the kmod command.
  resolution: "Configure the operating system to audit the execution of the module management\n            program \"kmod\".\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -w /bin/kmod -p x -k modules\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n\n                                                                                                 Page 392\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /bin/kmod%' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900740, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.172 UBTU-24-900750 (Automated)
  platform: linux
  description: The operating system must generate audit records for successful/unsuccessful attempts to use the fdisk command.
  resolution: "Configure the audit system to audit the execution of the partition management program\n            \"fdisk\".\n            Add or modify the following line in the \"/etc/audit/rules.d/stig.rules\" file:\n            -w /usr/sbin/fdisk -p x -k fdisk\n            To reload the rules file, issue the following command:\n            $ sudo augenrules --load\n            Note: The \"-k \" at the end of the line gives the rule a unique meaning to help during an\n            audit investigation. The does not need to match the example above.\n\n\n\n\n                                                                                                 Page 394\n\nInternal Only - General"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '%-w /usr/sbin/fdisk%' AND line LIKE '%-p x%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900750, cis_category:Audit Log Management, cis_subcategory:Collect Detailed Audit Logs, cis_safeguard_ids:CIS8.5
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.173 UBTU-24-900920 (Manual)
  platform: linux
  description: The operating system must allocate audit record storage capacity to store at least one weeks' worth of audit records, when audit records are not immediately sent to a central audit record storage facility.
  resolution: "Allocate enough storage capacity for at least one week's worth of audit records when\n            audit records are not immediately sent to a central audit record storage facility.\n            If audit records are stored on a partition made specifically for audit records, use the\n            \"parted\" program to resize the partition with sufficient space to contain one week's worth\n            of audit records.\n            If audit records are not stored on a partition made specifically for audit records, a new\n            partition with sufficient amount of space will need be to be created.\n            Set the auditd server to point to the mount point where the audit records must be\n            located:\n            $ sudo sed -i -E 's@^(log_file\\s*=\\s*).*@\\1\n            <audit_partition_mountpoint>/audit.log@' /etc/audit/auditd.conf\n            where <audit_partition_mountpoint> is the aforementioned mount point."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/audit/auditd.conf' AND line LIKE 'log_file%' AND line NOT LIKE '#%');
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900920, cis_category:Audit Log Management, cis_subcategory:Ensure Adequate Audit Log Storage, cis_safeguard_ids:CIS8.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.174 UBTU-24-900950 (Manual)
  platform: linux
  description: The operating system must have a crontab script running weekly to offload audit events of standalone systems.
  resolution: "Create a script that offloads audit logs to external media and runs weekly.\n            The script must be located in the \"/etc/cron.weekly\" directory."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM crontab WHERE command LIKE '%audit%');
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900950, cis_category:Audit Log Management, cis_subcategory:Establish and Maintain an Audit Log Management, cis_safeguard_ids:CIS8.1
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.175 UBTU-24-900960 (Manual)
  platform: linux
  description: The operating system must immediately notify the system administrator (SA) and information system security officer (ISSO) (at a minimum) when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity.
  resolution: "Edit \"/etc/audit/auditd.conf\" and set the \"space_left_action\" parameter to \"exec\" or\n            \"email\".\n            If the \"space_left_action\" parameter is set to \"email\", set the \"action_mail_acct\"\n            parameter to an email address for the SA and ISSO.\n            If the \"space_left_action\" parameter is set to \"exec\", ensure the command being\n            executed notifies the SA and ISSO.\n            Edit \"/etc/audit/auditd.conf\" and set the \"space_left\" parameter to be at least 25 percent\n            of the repository maximum audit record storage capacity."
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/audit/auditd.conf' AND line LIKE 'space_left_action%' AND line NOT LIKE '#%');
  purpose: Optional
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900960, cis_category:Audit Log Management, cis_subcategory:Collect Audit Logs, cis_safeguard_ids:CIS8.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.176 UBTU-24-900980 (Automated)
  platform: linux
  description: The operating system must alert the information system security officer (ISSO) and system administrator (SA) in the event of an audit processing failure.
  resolution: "Configure \"auditd\" service to notify the SA and ISSO in the event of an audit processing\n            failure.\n            Edit the following line in \"/etc/audit/auditd.conf\" to ensure administrators are notified via\n            email for those situations:\n            action_mail_acct = <administrator_email_account>\n            Note: Change \"administrator_email_account\" to the email address of the SA and/or\n            ISSO.\n            Restart the \"auditd\" service for the changes take effect:\n            $ sudo systemctl restart auditd.service"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/audit/auditd.conf' AND line LIKE 'action_mail_acct%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_900980, cis_category:Audit Log Management, cis_subcategory:Collect Audit Logs, cis_safeguard_ids:CIS8.2
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.177 UBTU-24-901220 (Automated)
  platform: linux
  description: The operating system must record time stamps for audit records that can be mapped to Coordinated Universal Time (UTC).
  resolution: "To Configure the operating system time zone to use UTC or GMT, run the following\n            command, replacing [ZONE] with UTC or GMT:\n            $ sudo timedatectl set-timezone [ZONE]"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/timezone' AND line LIKE '%UTC%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:3, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_901220, cis_category:Audit Log Management, cis_subcategory:Standardize Time Synchronization, cis_safeguard_ids:CIS8.4
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.178 UBTU-24-901230 (Automated)
  platform: linux
  description: The operating system must configure audit tools with a mode of "755" or less permissive.
  resolution: "Configure the audit tools on the operating system to be protected from unauthorized\n            access by setting the correct permissive mode using the following command:\n            $ sudo chmod 755 <audit_tool_name>\n            Replace \"<audit_tool_name>\" with the audit tool that does not have the correct\n            permissions."
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/sbin/auditctl','/sbin/auditd','/sbin/ausearch','/sbin/aureport','/sbin/autrace','/sbin/audispd','/sbin/augenrules') AND mode > '0755');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_901230, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.179 UBTU-24-901240 (Automated)
  platform: linux
  description: The operating system must configure audit tools to be owned by "root".
  resolution: "Configure the audit tools on the operating system to be protected from unauthorized\n            access by setting the file owner as root using the following command:\n            $ sudo chown root <audit_tool_name>\n            Replace \"<audit_tool_name>\" with each audit tool not owned by \"root\"."
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/sbin/auditctl','/sbin/auditd','/sbin/ausearch','/sbin/aureport','/sbin/autrace','/sbin/audispd','/sbin/augenrules') AND uid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_901240, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.180 UBTU-24-901250 (Automated)
  platform: linux
  description: The operating system must configure the audit tools to be group-owned by root.
  resolution: "Configure the audit tools on the operating system to be protected from unauthorized\n            access by setting the file group as root using the following command:\n            $ sudo chown :root [audit_tool]\n            Replace \"[audit_tool]\" with each audit tool not group-owned by root."
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/sbin/auditctl','/sbin/auditd','/sbin/ausearch','/sbin/aureport','/sbin/autrace','/sbin/audispd','/sbin/augenrules') AND gid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_901250, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.181 UBTU-24-901260 (Automated)
  platform: linux
  description: The operating system must have directories that contain system commands set to a mode of "755" or less permissive.
  resolution: "Configure the operating system commands directories to be protected from\n            unauthorized access. Run the following command:\n            $ sudo find /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin -\n            perm /022 -type d -exec chmod -R 755 '{}' \\;\n\n\n\n\n                                                                                                 Page 412\n\nInternal Only - General"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/bin','/sbin','/usr/bin','/usr/sbin','/usr/local/bin','/usr/local/sbin') AND type='directory' AND mode > '0755');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_901260, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.182 UBTU-24-901270 (Automated)
  platform: linux
  description: The operating system must have directories that contain system commands owned by "root".
  resolution: "Configure the operating system commands directories to be protected from\n            unauthorized access. Run the following command:\n            $ sudo find /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin ! -\n            user root -type d -exec chown root '{}' \\;\n\n\n\n\n                                                                                              Page 414\n\nInternal Only - General"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/bin','/sbin','/usr/bin','/usr/sbin','/usr/local/bin','/usr/local/sbin') AND type='directory' AND uid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_901270, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.183 UBTU-24-901280 (Automated)
  platform: linux
  description: The operating system must have directories that contain system commands group- owned by "root".
  resolution: "Configure the operating system commands directories to be protected from\n            unauthorized access. Run the following command:\n            $ sudo find /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin ! -\n            group root -type d -exec chgrp root '{}' \\;\n\n\n\n\n                                                                                              Page 416\n\nInternal Only - General"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path IN ('/bin','/sbin','/usr/bin','/usr/sbin','/usr/local/bin','/usr/local/sbin') AND type='directory' AND gid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_901280, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.184 UBTU-24-901300 (Automated)
  platform: linux
  description: The operating system must be configured so that audit log files are not read- or write- accessible by unauthorized users.
  resolution: "Configure the audit log files to have a mode of \"600\" or less permissive.\n            Using the path of the directory containing the audit logs, configure the audit log files to\n            have a mode of \"600\" or less permissive by using the following command:\n            $ sudo chmod 600 /var/log/audit/*"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path LIKE '/var/log/audit/%' AND mode > '0600');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_901300, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.185 UBTU-24-901310 (Automated)
  platform: linux
  description: The operating system must be configured to permit only authorized users ownership of the audit log files.
  resolution: "Configure the audit log directory and its underlying files to be owned by \"root\" user.\n            Using the path of the directory containing the audit logs, configure the audit log files to\n            be owned by \"root\" user by using the following command:\n            $ sudo chown root /var/log/audit/*"
  query: SELECT 1 WHERE NOT EXISTS (SELECT 1 FROM file WHERE path LIKE '/var/log/audit/%' AND uid != 0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_901310, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.186 UBTU-24-901350 (Automated)
  platform: linux
  description: The operating system must permit only authorized groups ownership of the audit log files.
  resolution: "Configure the audit log directory and its underlying files to be owned by \"root\" group.\n            Set the \"log_group\" parameter of the audit configuration file to the \"root\" value so when\n            a new log file is created, its group owner is properly set:\n            $ sudo sed -i '/^log_group/D' /etc/audit/auditd.conf\n            $ sudo sed -i /^log_file/a'log_group = root' /etc/audit/auditd.conf\n            Signal the audit daemon to reload the configuration file to update the group owners of\n            existing files:\n            $ sudo systemctl kill auditd -s SIGHUP"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE path='/etc/audit/auditd.conf' AND line LIKE 'log_group = root%' AND line NOT LIKE '#%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_901350, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.187 UBTU-24-901380 (Automated)
  platform: linux
  description: The operating system must be configured so that the audit log directory is not write- accessible by unauthorized users.
  resolution: "Configure the audit log directory to have a mode of \"0750\" or less permissive.\n            Determine where the audit logs are stored with the following command:\n            $ sudo grep -iw ^log_file /etc/audit/auditd.conf\n\n            log_file = /var/log/audit/audit.log\n            Using the path of the directory containing the audit logs, configure the audit log directory\n            to have a mode of \"0750\" or less permissive by using the following command:\n            $ sudo chmod -R          750 /var/log/audit"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file WHERE path='/var/log/audit' AND mode <= '0750' AND uid=0);
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_901380, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
---
apiVersion: v1
kind: policy
spec:
  name: CIS 1.188 UBTU-24-909000 (Automated)
  platform: linux
  description: The operating system's audit system must protect auditing rules from unauthorized change.
  resolution: "Configure the audit system to set the audit rules to be immutable by adding the\n            following line to the end of \"/etc/audit/rules.d/audit.rules\":\n            -e 2"
  query: SELECT 1 WHERE EXISTS (SELECT 1 FROM file_lines WHERE (path LIKE '/etc/audit/rules.d/%' OR path='/etc/audit/audit.rules') AND line LIKE '-e 2%');
  purpose: Enforcement
  tags: framework:CISv8.1, benchmark:ubuntu24.04, level:2, platform:linux, category:os, requirement:standard, critical:false, control:ubtu_24_909000, cis_category:Data Protection, cis_subcategory:Configure Data Access Control Lists, cis_safeguard_ids:CIS3.3
  contributors: karmine05
